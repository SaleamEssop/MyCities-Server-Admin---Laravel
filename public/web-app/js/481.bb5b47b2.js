"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[481],{4187:(e,t,l)=>{l.d(t,{t:()=>s,w:()=>i});var a=l(1569);const i=(e,t)=>a.api.get(`/v1/meters/${e}/cost-estimation`,{params:{month:t}}),s=(e,t)=>a.api.get(`/v1/meters/account/${e}/complete-bill`,{params:{month:t}})},2947:(e,t,l)=>{l.d(t,{Y:()=>n});var a=l(1448),i=l(4170),s=l(9302);const n=()=>{const e=(0,s.Z)();return{mailCost(t){const l=t.current_date,s=t.meter_details,n=t.usage,o=t.account,r=s.meter_type_id===a.w?o.water_email:o.electricity_email,u=`Account: ${o.account_number}`;let d="";d+=`Account Number: ${o.account_number}\n`,d+=`Account Holder: ${o.account_name}\n`,s.meter_type_id===a.w?d+=`Water Meter: ${s.meter_title}\n`:s.meter_type_id===a.E&&(d+=`Electricity Meter: ${s.meter_title}\n`),d+=`Current Reading: ${n.reading}\n`,d+=`Date: ${l}\n\n\n\n\n`,d+="Powered by the MyCities App.\n",d+="Visit www.mycities.co.za for information on how we can help you save on electricity and water with cutting edge technologies.";let c="mailto:"+encodeURI(r)+"?subject="+encodeURI(u)+"&body="+encodeURI(d);const m=i.ZP.formatDate(new Date,"DD");m>=25&&m<=23?window.open(c,"_blank"):e.dialog({title:"Confirm",message:"You are outside the meter reading submission dates. Are you sure you want to email the reading for this meter?",cancel:!0,persistent:!0}).onOk((()=>{window.open(c,"_blank")})).onCancel((()=>{}))}}}},5990:(e,t,l)=>{l.d(t,{h:()=>i});const a=new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),i=()=>({numberFormat(e){return"number"!==typeof e?e:a.format(e)}})},6094:(e,t,l)=>{l.d(t,{z:()=>s});var a=l(1448);const i=new Intl.NumberFormat("en-US"),s=()=>({unitFormat(e,t){return"number"!==typeof e?e:t===a.w?`${i.format(e)} kL`:t===a.E?`${i.format(e)} kWh`:void 0},klToLitters(e){return"number"!==typeof e?e:`${i.format(1e3*e)} L`}})},1448:(e,t,l)=>{l.d(t,{E:()=>i,w:()=>a});const a=1,i=2},481:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ue});l(8964);var a=l(9835),i=l(6970),s=l(499),n=l(8339),o=l(4187),r=l(5990),u=l(6094),d=l(1448),c=l(2947);const m=e=>((0,a.dD)("data-v-9372c612"),e=e(),(0,a.Cn)(),e),v={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},_={class:"large-text"},w={class:"medium-text"},y={class:"medium-text"},g={class:"medium-text"},p={key:0,class:"q-ma-sm q-pa-sm",style:{display:"flex","justify-content":"center","align-items":"center","min-height":"300px"}},f={class:"row flex justify-between items-center"},b={class:"column col-3"},h=m((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),k={class:"text-center basic-text"},U={class:"column col-3"},q=m((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),x={class:"text-center basic-text"},W={class:"column col-3"},z=m((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),S={class:"basic-text text-center"},D={class:"row flex justify-between items-center"},j={class:"column col-3"},C=m((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),F={class:"text-center basic-text"},Z={class:"column col-3"},R=m((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),$={class:"text-center basic-text"},Q={class:"column col-3"},H=m((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),I={class:"basic-text text-center"},T=(0,a.Uk)("Water in"),M=(0,a.Uk)("Water out"),Y=(0,a.Uk)("VAT"),E={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},A=m((()=>(0,a._)("span",{class:"large-text"},"Monthly Projected Cost",-1))),L={class:"large-text"},P={class:"flex column items-center q-pt-lg","aria-label":"heading"},K=(0,a.Uk)("Email Details"),N={__name:"MeterCost",setup(e){const t=(0,n.yj)(),l=(0,n.tv)(),m=(0,r.h)(),N=(0,u.z)(),B=(0,s.iH)({}),V=(0,s.iH)(!1),O=(0,c.Y)();let G=t.query.month;G<0&&l.replace({...t,query:{...t.query,month:1}});const J=(0,s.iH)(t.query.month||1);function X(){var e;null!==(e=B.value)&&void 0!==e&&e.has_history&&(J.value++,l.push({...t,query:{...t.query,month:J.value}}))}function ee(){J.value--,l.push({...t,query:{...t.query,month:J.value}})}async function te(){try{B.value=await(0,o.w)(t.params.id,J.value),V.value=!1}catch(e){V.value=!0,B.value=e.response.data}}return(0,a.m0)((async()=>{J.value=t.query.month||1,await te()})),(0,a.bv)((()=>{te().then()})),(e,l)=>{var n,o,r,u,c,G,te,le;const ae=(0,a.up)("q-btn"),ie=(0,a.up)("q-toolbar-title"),se=(0,a.up)("q-toolbar"),ne=(0,a.up)("q-header"),oe=(0,a.up)("q-icon"),re=(0,a.up)("q-card"),ue=(0,a.up)("q-banner"),de=(0,a.up)("q-separator"),ce=(0,a.up)("q-item-section"),me=(0,a.up)("q-item"),ve=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(ne,{elevated:"",class:"containerWidth new-meter-heading breadcrumbs"},{default:(0,a.w5)((()=>[(0,a.Wm)(se,null,{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{onClick:l[0]||(l[0]=t=>e.$router.back()),flat:"",dense:"",round:"",icon:"arrow_back","text-color":"white"}),(0,a.Wm)(ie,{class:"text-white"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)((0,s.SU)(t).meta.title),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(re,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t,l,s,n;return[(0,a._)("div",v,[(0,a._)("span",_,"Meter# "+(0,i.zw)(null===(e=B.value)||void 0===e||null===(t=e.meter_details)||void 0===t?void 0:t.meter_number),1),(0,a._)("div",w,[null!==(l=B.value)&&void 0!==l&&l.has_history?((0,a.wg)(),(0,a.j4)(oe,{key:0,onClick:X,name:"arrow_left",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(oe,{key:1,disabled:"",name:"arrow_left",class:"icon-styling"})),(0,a._)("span",null," Projected bill for "+(0,i.zw)(null===(s=B.value)||void 0===s?void 0:s.month),1),J.value>1?((0,a.wg)(),(0,a.j4)(oe,{key:2,onClick:ee,name:"arrow_right",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(oe,{key:3,disabled:"",name:"arrow_right",class:"icon-styling"}))]),(0,a._)("span",y,(0,i.zw)(null===(n=B.value)||void 0===n?void 0:n.cycle),1),(0,a._)("span",g,"Today is "+(0,i.zw)(B.value.current_date),1)])]})),_:1}),V.value?((0,a.wg)(),(0,a.iD)("div",p,[(0,a.Wm)(ue,{dense:"","inline-actions":"",class:"text-white bg-red"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(B.value.message),1)])),_:1})])):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(null===(n=B.value)||void 0===n||null===(o=n.meter_details)||void 0===o?void 0:o.meter_type_id)===(0,s.SU)(d.w)?((0,a.wg)(),(0,a.j4)(re,{key:0,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t,l,n,o,r,u,d;return[(0,a._)("div",f,[(0,a._)("div",b,[h,(0,a._)("div",k,(0,i.zw)((0,s.SU)(N).klToLitters((null===(e=B.value)||void 0===e||null===(t=e.usage)||void 0===t?void 0:t.average_usage)||0)),1)]),(0,a.Wm)(de,{vertical:""}),(0,a._)("div",U,[q,(0,a._)("div",x,(0,i.zw)((0,s.SU)(N).unitFormat((null===(l=B.value)||void 0===l||null===(n=l.usage)||void 0===n?void 0:n.predictive_monthly_usage)||0,null===(o=B.value)||void 0===o||null===(r=o.meter_details)||void 0===r?void 0:r.meter_type_id)),1)]),(0,a.Wm)(de,{vertical:""}),(0,a._)("div",W,[z,(0,a._)("div",S," R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===(u=B.value)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.daily_predictive_cost)||0)),1)])]),(0,a.Wm)(de,{class:"q-mt-lg"})]})),_:1})):(null===(r=B.value)||void 0===r||null===(u=r.meter_details)||void 0===u?void 0:u.meter_type_id)===(0,s.SU)(d.E)?((0,a.wg)(),(0,a.j4)(re,{key:1,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t,l,n,o,r,u,d,c,v;return[(0,a._)("div",D,[(0,a._)("div",j,[C,(0,a._)("div",F,(0,i.zw)((0,s.SU)(N).unitFormat((null===(e=B.value)||void 0===e||null===(t=e.usage)||void 0===t?void 0:t.average_usage)||0,null===(l=B.value)||void 0===l||null===(n=l.meter_details)||void 0===n?void 0:n.meter_type_id)),1)]),(0,a.Wm)(de,{vertical:""}),(0,a._)("div",Z,[R,(0,a._)("div",$,(0,i.zw)((0,s.SU)(N).unitFormat((null===(o=B.value)||void 0===o||null===(r=o.usage)||void 0===r?void 0:r.predictive_monthly_usage)||0,null===(u=B.value)||void 0===u||null===(d=u.meter_details)||void 0===d?void 0:d.meter_type_id)),1)]),(0,a.Wm)(de,{vertical:""}),(0,a._)("div",Q,[H,(0,a._)("div",I," R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===(c=B.value)||void 0===c||null===(v=c.data)||void 0===v?void 0:v.daily_predictive_cost)||0)),1)])]),(0,a.Wm)(de,{class:"q-mt-lg"})]})),_:1})):(0,a.kq)("",!0),(null===(c=B.value)||void 0===c||null===(G=c.meter_details)||void 0===G?void 0:G.meter_type_id)===(0,s.SU)(d.w)?((0,a.wg)(),(0,a.j4)(re,{key:2,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,t,l,n,o,r,u,d;return[(0,a.Wm)(me,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{class:"item-styling"},{default:(0,a.w5)((()=>[T])),_:1}),(0,a.Wm)(ce,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>{var e,t,l;return[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===(e=B.value)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.water_in)||void 0===l?void 0:l.predictive.total)||0)),1)]})),_:1})])),_:1}),(0,a.Wm)(me,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{class:"item-styling"},{default:(0,a.w5)((()=>[M])),_:1}),(0,a.Wm)(ce,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>{var e,t,l;return[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===(e=B.value)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.water_out)||void 0===l?void 0:l.predictive.total)||0)),1)]})),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=B.value)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.water_in)||void 0===l||null===(n=l.predictive)||void 0===n?void 0:n.additional_costs)||[],((e,t)=>((0,a.wg)(),(0,a.j4)(me,{class:"item-style",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ce,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(o=B.value)||void 0===o||null===(r=o.data)||void 0===r||null===(u=r.water_out)||void 0===u||null===(d=u.predictive)||void 0===d?void 0:d.additional_costs)||[],((e,t)=>((0,a.wg)(),(0,a.j4)(me,{class:"item-style",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ce,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),(0,a.Wm)(me,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{class:"item-styling"},{default:(0,a.w5)((()=>[Y])),_:1}),(0,a.Wm)(ce,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>{var e,t;return[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===(e=B.value)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.vat_predictive)||0)),1)]})),_:1})])),_:1})]})),_:1})])),_:1})):(null===(te=B.value)||void 0===te||null===(le=te.meter_details)||void 0===le?void 0:le.meter_type_id)===(0,s.SU)(d.E)?((0,a.wg)(),(0,a.j4)(re,{key:3,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,t,l,n;return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=B.value)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.electricity)||void 0===l||null===(n=l.predictive)||void 0===n?void 0:n.additional_costs)||[],((e,t)=>((0,a.wg)(),(0,a.j4)(me,{class:"item-style",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ce,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128))]})),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(re,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t;return[(0,a._)("div",E,[A,(0,a._)("span",L,"R "+(0,i.zw)((0,s.SU)(m).numberFormat((null===(e=B.value)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.predictive)||0)),1)])]})),_:1}),(0,a.Wm)(re,{flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a._)("div",P,[(0,a.Wm)(ae,{color:"primary",style:{width:"100%"},onClick:l[1]||(l[1]=e=>(0,s.SU)(O).mailCost(B.value))},{default:(0,a.w5)((()=>[K])),_:1})])])),_:1})],64))],64)}}};var B=l(1639),V=l(6602),O=l(1663),G=l(8879),J=l(1973),X=l(4458),ee=l(2857),te=l(7128),le=l(926),ae=l(3246),ie=l(490),se=l(1233),ne=l(9984),oe=l.n(ne);const re=(0,B.Z)(N,[["__scopeId","data-v-9372c612"]]),ue=re;oe()(N,"components",{QHeader:V.Z,QToolbar:O.Z,QBtn:G.Z,QToolbarTitle:J.Z,QCard:X.Z,QIcon:ee.Z,QBanner:te.Z,QSeparator:le.Z,QList:ae.Z,QItem:ie.Z,QItemSection:se.Z})}}]);