"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[667],{3667:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});a(310),a(5962),a(199),a(7346);var l=a(1758),n=a(8790),c=a(9104),o=a(8734),i=a(3394),s=a(4907),u=a(4685);const d={class:"select-container"},r={class:"header-section"},m={class:"welcome-text"},v={class:"welcome-title"},g={class:"create-new-section"},p={class:"accounts-grid"},k=["onClick"],b={class:"card-content"},f={class:"account-name"},_={key:0,class:"no-accounts"},y={key:1,class:"continue-section"},h={class:"logout-section"},C={__name:"AccountSelectPage",setup(e){const t=(0,i.rd)(),a=(0,s.A)(),C=(0,o.KR)(null),F=(0,o.KR)(!1),A=(0,o.KR)(null),L=(0,u.Ht)(),Q=(0,l.EW)(()=>L?.fullName||L?.email?.split("@")[0]||"User"),q=(0,o.KR)([{id:1,name:"Main House",description:"Primary residence",region:"Durban"},{id:2,name:"Out Building",description:"Granny flat",region:"Durban"}]);function S(){const e=localStorage.getItem("mycities_user_accounts");if(e)try{q.value=JSON.parse(e)}catch(e){console.error("Failed to parse accounts:",e)}1===q.value.length&&(C.value=q.value[0].id)}function w(e){C.value=e.id,localStorage.setItem("mycities_selected_account",e.id),a.notify({type:"positive",message:`Account "${e.name}" selected`,position:"top"}),t.push({name:"home"})}function I(){C.value&&(localStorage.setItem("mycities_selected_account",C.value),a.notify({type:"positive",message:"Account selected",position:"top"}),t.push({name:"home"}))}function D(){t.push({name:"account-new"})}function W(e){t.push({name:"account-edit",params:{accountId:e.id}})}function X(e){A.value=e,F.value=!0}function x(){A.value&&(q.value=q.value.filter(e=>e.id!==A.value.id),localStorage.setItem("mycities_user_accounts",JSON.stringify(q.value)),C.value===A.value.id&&(C.value=null),a.notify({type:"positive",message:`${A.value.name} deleted`,position:"top"}),F.value=!1,A.value=null)}function E(){(0,u.ri)(),a.notify({type:"info",message:"Signed out successfully",position:"top"}),t.push({name:"login"})}return(0,l.sV)(()=>{S()}),(e,t)=>{const a=(0,l.g2)("q-icon"),o=(0,l.g2)("q-item-section"),i=(0,l.g2)("q-item"),s=(0,l.g2)("q-list"),u=(0,l.g2)("q-menu"),L=(0,l.g2)("q-btn"),S=(0,l.g2)("q-card-section"),K=(0,l.g2)("q-card-actions"),N=(0,l.g2)("q-card"),$=(0,l.g2)("q-dialog"),P=(0,l.g2)("q-page"),R=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(P,{class:"account-select-page"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",d,[(0,l.Lk)("div",r,[(0,l.Lk)("div",m,[(0,l.Lk)("h1",v,"Welcome, "+(0,n.v_)(Q.value),1)])]),(0,l.Lk)("div",g,[(0,l.Lk)("a",{href:"#",class:"create-link",onClick:(0,c.D$)(D,["prevent"]),"data-test":"account-select-create"}," Create a new account ")]),(0,l.Lk)("div",p,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(q.value,e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:(0,n.C4)(["account-card",{selected:C.value===e.id}]),onClick:t=>w(e),"data-test":"account-card"},[(0,l.Lk)("div",b,[(0,l.Lk)("span",f,(0,n.v_)(e.name),1)]),(0,l.bF)(L,{flat:"",round:"",dense:"",icon:"more_vert",class:"menu-btn",onClick:t[0]||(t[0]=(0,c.D$)(()=>{},["stop"])),"data-test":"account-menu-btn"},{default:(0,l.k6)(()=>[(0,l.bF)(u,{anchor:"bottom right",self:"top right"},{default:(0,l.k6)(()=>[(0,l.bF)(s,{style:{"min-width":"150px"}},{default:(0,l.k6)(()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(i,{clickable:"",onClick:t=>W(e),"data-test":"account-edit"},{default:(0,l.k6)(()=>[(0,l.bF)(o,{avatar:""},{default:(0,l.k6)(()=>[(0,l.bF)(a,{name:"edit",color:"primary"})]),_:1}),(0,l.bF)(o,null,{default:(0,l.k6)(()=>[...t[2]||(t[2]=[(0,l.eW)("Edit",-1)])]),_:1})]),_:1},8,["onClick"])),[[R]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(i,{clickable:"",onClick:t=>X(e),"data-test":"account-delete"},{default:(0,l.k6)(()=>[(0,l.bF)(o,{avatar:""},{default:(0,l.k6)(()=>[(0,l.bF)(a,{name:"delete",color:"negative"})]),_:1}),(0,l.bF)(o,{class:"text-negative"},{default:(0,l.k6)(()=>[...t[3]||(t[3]=[(0,l.eW)("Delete",-1)])]),_:1})]),_:1},8,["onClick"])),[[R]])]),_:2},1024)]),_:2},1024)]),_:2},1024)],10,k))),128))]),0===q.value.length?((0,l.uX)(),(0,l.CE)("div",_,[(0,l.bF)(a,{name:"account_balance",size:"64px",color:"grey-5"}),t[4]||(t[4]=(0,l.Lk)("p",null,"No accounts yet",-1)),(0,l.bF)(L,{color:"primary",label:"Create Your First Account",onClick:D,"data-test":"account-select-create-first"})])):(0,l.Q3)("",!0),C.value&&q.value.length>0?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.bF)(L,{color:"primary",label:"Continue",class:"continue-btn",onClick:I,"data-test":"account-select-continue"})])):(0,l.Q3)("",!0),(0,l.Lk)("div",h,[(0,l.Lk)("a",{href:"#",class:"logout-link",onClick:(0,c.D$)(E,["prevent"]),"data-test":"account-select-logout"}," Sign out ")])]),(0,l.bF)($,{modelValue:F.value,"onUpdate:modelValue":t[1]||(t[1]=e=>F.value=e),persistent:""},{default:(0,l.k6)(()=>[(0,l.bF)(N,{style:{"min-width":"300px"}},{default:(0,l.k6)(()=>[(0,l.bF)(S,null,{default:(0,l.k6)(()=>[...t[5]||(t[5]=[(0,l.Lk)("div",{class:"text-h6"},"Delete Account",-1)])]),_:1}),(0,l.bF)(S,{class:"q-pt-none"},{default:(0,l.k6)(()=>[t[6]||(t[6]=(0,l.eW)(" Are you sure you want to delete ",-1)),(0,l.Lk)("strong",null,(0,n.v_)(A.value?.name),1),t[7]||(t[7]=(0,l.eW)("? This action cannot be undone. ",-1))]),_:1}),(0,l.bF)(K,{align:"right"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(L,{flat:"",label:"Cancel",color:"grey"},null,512),[[R]]),(0,l.bF)(L,{flat:"",label:"Delete",color:"negative",onClick:x,"data-test":"account-delete-confirm"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};var F=a(2807),A=a(7716),L=a(6384),Q=a(4436),q=a(3999),S=a(124),w=a(5173),I=a(492),D=a(2156),W=a(3316),X=a(4189),x=a(2669),E=a(8672),K=a(8582),N=a.n(K);const $=(0,F.A)(C,[["__scopeId","data-v-6b7b7390"]]),P=$;N()(C,"components",{QPage:A.A,QBtn:L.A,QMenu:Q.A,QList:q.A,QItem:S.A,QItemSection:w.A,QIcon:I.A,QDialog:D.A,QCard:W.A,QCardSection:X.A,QCardActions:x.A}),N()(C,"directives",{ClosePopup:E.A})}}]);