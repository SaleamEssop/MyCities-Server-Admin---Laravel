"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[481],{4187:(e,t,l)=>{l.d(t,{t:()=>n,w:()=>i});var a=l(1569);const i=(e,t)=>a.api.get(`/v1/meters/${e}/cost-estimation`,{params:{month:t}}),n=(e,t)=>a.api.get(`/v1/meters/account/${e}/complete-bill`,{params:{month:t}})},7142:(e,t,l)=>{l.d(t,{Y:()=>z});var a=l(1448),i=l(4170),n=l(9302),o=l(9835);const s=(0,o._)("span",{style:{"font-size":"2rem"}},"Reminder",-1),r=(0,o._)("p",{style:{"font-size":"1.5rem"}}," Some municipalities require an image of your meter to be sent with the email. Do remember to attach the image to the email. ",-1);function d(e,t,l,a,i,n){const d=(0,o.up)("q-toolbar"),u=(0,o.up)("q-card-section"),c=(0,o.up)("q-btn"),m=(0,o.up)("q-card-actions"),v=(0,o.up)("q-card"),_=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(_,{ref:"dialogRef",onHide:a.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"bg-primary text-white shadow-2 flex flex-center"},{default:(0,o.w5)((()=>[s])),_:1}),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(m,{align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"primary",label:"Okay",onClick:a.onOKClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}l(702);var u=l(4182);const c={props:{},emits:[...u.Z.emits],setup(){const{dialogRef:e,onDialogHide:t,onDialogOK:l,onDialogCancel:a}=(0,u.Z)();return{dialogRef:e,onDialogHide:t,onOKClick(){l()},onCancelClick:a}}};var m=l(1639),v=l(3706),_=l(4458),w=l(1663),g=l(3190),p=l(1821),y=l(8879),f=l(9984),b=l.n(f);const k=(0,m.Z)(c,[["render",d]]),h=k;b()(c,"components",{QDialog:v.Z,QCard:_.Z,QToolbar:w.Z,QCardSection:g.Z,QCardActions:p.Z,QBtn:y.Z});var x=l(6094);const W=(0,o._)("span",{style:{"font-size":"2rem"}},"Caution",-1),U=(0,o._)("p",{style:{"font-size":"1.5rem"}}," You are outside the meter reading submission dates. Are you sure you want to email the reading for this meter? ",-1);function q(e,t,l,a,i,n){const s=(0,o.up)("q-toolbar"),r=(0,o.up)("q-card-section"),d=(0,o.up)("q-btn"),u=(0,o.up)("q-card-actions"),c=(0,o.up)("q-card"),m=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(m,{ref:"dialogRef",onHide:a.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"bg-primary text-white shadow-2 flex flex-center"},{default:(0,o.w5)((()=>[W])),_:1}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[U])),_:1}),(0,o.Wm)(u,{align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{color:"primary",label:"Okay",onClick:a.onOKClick},null,8,["onClick"]),(0,o.Wm)(d,{color:"red-7",label:"Cancel",onClick:a.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const C={props:{},emits:[...u.Z.emits],setup(){const{dialogRef:e,onDialogHide:t,onDialogOK:l,onDialogCancel:a}=(0,u.Z)();return{dialogRef:e,onDialogHide:t,onOKClick(){l()},onCancelClick:a}}},D=(0,m.Z)(C,[["render",q]]),Z=D;b()(C,"components",{QDialog:v.Z,QCard:_.Z,QToolbar:w.Z,QCardSection:g.Z,QCardActions:p.Z,QBtn:y.Z});const z=()=>{const e=(0,n.Z)(),t=(0,x.z)();return{mailCost(l){const n=l.current_date,o=l.meter_details,s=l.usage,r=l.account,d=o.meter_type_id===a.w?r.water_email:r.electricity_email,u=`Account: ${r.account_number}`;let c="";c+=`Account Number: ${r.account_number}\n`,c+=`Account Holder: ${r.account_name}\n`,(o.meter_type_id===a.w||o.meter_type_id===a.E)&&(c+=`Meter Number: ${o.meter_number}\n`),c+=`Current Reading: ${t.unitFormat(s.current_reading,o.meter_type_id,!0)}\n`,c+=`Date: ${n}\n\n\n\n\n`,c+="Powered by the MyCities App.\n",c+="Visit www.mycities.co.za for information on how we can help you save on electricity and water with cutting edge technologies.";let m="mailto:"+encodeURI(d)+"?subject="+encodeURI(u)+"&body="+encodeURI(c);const v=i.ZP.formatDate(new Date,"DD");v>=25&&v<=23?e.dialog({component:h}).onOk((()=>{window.open(m,"_blank")})).onCancel((()=>{window.open(m,"_blank")})):e.dialog({component:Z}).onOk((()=>{e.dialog({component:h}).onOk((()=>{window.open(m,"_blank")})).onCancel((()=>{window.open(m,"_blank")}))})).onCancel((()=>{}))}}}},5990:(e,t,l)=>{l.d(t,{h:()=>i});const a=new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),i=()=>({numberFormat(e){return"number"!==typeof e?e:a.format(e)}})},6094:(e,t,l)=>{l.d(t,{z:()=>n});var a=l(1448);const i=new Intl.NumberFormat("en-US"),n=()=>{function e(e){const t=e.toString(),l=t.split("."),a=l[0].padStart(4,"0"),i=l[1]||"";return`${a}.${i}`}function t(e){const t=e.toString(),l=t.split("."),a=l[0].padStart(5,"0"),i=l[1]||"";return`${a}.${i}`}return{unitFormat(l,i,n=!1){return"number"!==typeof l?l:i===a.w?n?`${e(l.toFixed(2))} kL`:`${l.toFixed(2)} kL`:i===a.E?n?(console.log(l),`${t(l.toFixed(1))} kWh`):`${l.toFixed(2)} kWh`:void 0},klToLitters(e){return"number"!==typeof e?e:`${i.format(1e3*e)} L`}}}},1448:(e,t,l)=>{l.d(t,{E:()=>i,w:()=>a});const a=1,i=2},481:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Ue});var a=l(9835),i=l(6970),n=l(499),o=l(8339),s=l(4187),r=l(5990),d=l(6094),u=l(1448),c=l(7142),m=l(9302);const v=e=>((0,a.dD)("data-v-45364f03"),e=e(),(0,a.Cn)(),e),_={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},w={class:"medium-text"},g={class:"large-text",style:{display:"flex"}},p={style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},y={class:"large-text"},f={class:"medium-text"},b={style:{"font-size":"3rem","font-weight":"bold"}},k={key:0,class:"q-ma-sm q-pa-sm",style:{display:"flex","justify-content":"center","align-items":"center","min-height":"300px"}},h={key:0,style:{"text-align":"justify"}},x=(0,a.Uk)(" Dear User. "),W=v((()=>(0,a._)("br",null,null,-1))),U=v((()=>(0,a._)("br",null,null,-1))),q=(0,a.Uk)(" You have either entered your first reading for this meter or, no usable previous readings exist. "),C=v((()=>(0,a._)("br",null,null,-1))),D=v((()=>(0,a._)("br",null,null,-1))),Z=(0,a.Uk)(" No problem. Just enter an additional reading in the next fews days to enable us to calculate your usage. "),z=v((()=>(0,a._)("br",null,null,-1))),S=v((()=>(0,a._)("br",null,null,-1))),F=(0,a.Uk)(" We need at least two readings in the same billing cycle to calculate usage and cost. "),Q=[x,W,U,q,C,D,Z,z,S,F],j={key:1},R={class:"row flex justify-between items-center"},H={class:"column col-3"},$=v((()=>(0,a._)("b",{class:"text-center bold-text"},"Daily Usage",-1))),O={class:"text-center large-text bold-text"},T={class:"column col-3"},I=v((()=>(0,a._)("b",{class:"text-center bold-text"},"Monthly Usage",-1))),K={class:"text-center large-text bold-text"},Y={class:"column col-3"},A=v((()=>(0,a._)("b",{class:"text-center bold-text"},"Daily Cost",-1))),M={class:"text-center large-text bold-text"},E={class:"row flex justify-between items-center"},L={class:"column col-3"},N=v((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),B={class:"text-center basic-text"},P={class:"column col-3"},V=v((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),J={class:"text-center basic-text"},G={class:"column col-3"},X=v((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),ee={class:"basic-text text-center"},te=(0,a.Uk)("Water in"),le=(0,a.Uk)("Water out"),ae=(0,a.Uk)("VAT"),ie={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},ne=v((()=>(0,a._)("span",{class:"large-text"},"Monthly Projected Cost",-1))),oe={class:"large-text"},se={class:"flex column items-center q-pt-lg","aria-label":"heading"},re=(0,a.Uk)("Email Details "),de={__name:"MeterCost",setup(e){const t=(0,o.yj)(),l=((0,o.tv)(),(0,r.h)()),v=(0,d.z)(),x=(0,n.iH)({}),W=(0,n.iH)(!1),U=(0,c.Y)(),q=(0,n.iH)(1),C=(0,m.Z)();async function D(){var e,t;null!==(e=x.value)&&void 0!==e&&e.has_history&&(q.value+=(null===(t=x.value)||void 0===t?void 0:t.add_previous_months)||1,await z())}async function Z(){var e;null!==(e=x.value)&&void 0!==e&&e.has_future&&(q.value--,await z())}async function z(){C.loading.show();try{x.value=await(0,s.w)(t.params.id,q.value),W.value=!1}catch(e){W.value=!0,x.value=e.response.data}C.loading.hide()}return(0,a.bv)((()=>{z().then()})),(e,o)=>{var s,r,d,c,m,q,C,z;const S=(0,a.up)("q-btn"),F=(0,a.up)("q-toolbar-title"),de=(0,a.up)("q-toolbar"),ue=(0,a.up)("q-header"),ce=(0,a.up)("q-icon"),me=(0,a.up)("q-card"),ve=(0,a.up)("q-banner"),_e=(0,a.up)("q-separator"),we=(0,a.up)("q-item-section"),ge=(0,a.up)("q-item"),pe=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(ue,{elevated:"",class:"containerWidth new-meter-heading breadcrumbs"},{default:(0,a.w5)((()=>[(0,a.Wm)(de,null,{default:(0,a.w5)((()=>[(0,a.Wm)(S,{onClick:o[0]||(o[0]=t=>e.$router.back()),flat:"",dense:"",round:"",icon:"arrow_back","text-color":"white"}),(0,a.Wm)(F,{class:"text-white"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)((0,n.SU)(t).meta.title),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(me,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t,o,s,r,d,u;return[(0,a._)("div",_,[(0,a._)("span",w,"Projected Cost: Meter# "+(0,i.zw)(null===(e=x.value)||void 0===e||null===(t=e.meter_details)||void 0===t?void 0:t.meter_number),1),(0,a._)("div",g,[null!==(o=x.value)&&void 0!==o&&o.has_history?((0,a.wg)(),(0,a.j4)(ce,{key:0,onClick:D,name:"arrow_left",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(ce,{key:1,disabled:"",name:"arrow_left",class:"icon-styling"})),(0,a._)("div",p,[(0,a._)("span",y,(0,i.zw)(null===(s=x.value)||void 0===s?void 0:s.cycle),1),(0,a._)("span",f,"Current Date: "+(0,i.zw)(x.value.current_date),1)]),null!==(r=x.value)&&void 0!==r&&r.has_future?((0,a.wg)(),(0,a.j4)(ce,{key:2,onClick:Z,name:"arrow_right",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(ce,{key:3,disabled:"",name:"arrow_right",class:"icon-styling"}))]),(0,a._)("span",b,"R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(d=x.value)||void 0===d||null===(u=d.data)||void 0===u?void 0:u.predictive)||0)),1)])]})),_:1}),W.value?((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(ve,{dense:"","inline-actions":"",class:"bg-grey-4"},{default:(0,a.w5)((()=>[422===x.value.status_code?((0,a.wg)(),(0,a.iD)("p",h,Q)):((0,a.wg)(),(0,a.iD)("p",j,(0,i.zw)(x.value.message),1))])),_:1})])):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(null===(s=x.value)||void 0===s||null===(r=s.meter_details)||void 0===r?void 0:r.meter_type_id)===(0,n.SU)(u.w)?((0,a.wg)(),(0,a.j4)(me,{key:0,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t,o,s,r,d,u,c;return[(0,a._)("div",R,[(0,a._)("div",H,[$,(0,a._)("div",O,(0,i.zw)((0,n.SU)(v).klToLitters((null===(e=x.value)||void 0===e||null===(t=e.usage)||void 0===t?void 0:t.average_usage)||0)),1)]),(0,a.Wm)(_e,{vertical:""}),(0,a._)("div",T,[I,(0,a._)("div",K,(0,i.zw)((0,n.SU)(v).unitFormat((null===(o=x.value)||void 0===o||null===(s=o.usage)||void 0===s?void 0:s.predictive_monthly_usage)||0,null===(r=x.value)||void 0===r||null===(d=r.meter_details)||void 0===d?void 0:d.meter_type_id)),1)]),(0,a.Wm)(_e,{vertical:""}),(0,a._)("div",Y,[A,(0,a._)("div",M," R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(u=x.value)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.daily_predictive_cost)||0)),1)])]),(0,a.Wm)(_e,{class:"q-mt-lg"})]})),_:1})):(null===(d=x.value)||void 0===d||null===(c=d.meter_details)||void 0===c?void 0:c.meter_type_id)===(0,n.SU)(u.E)?((0,a.wg)(),(0,a.j4)(me,{key:1,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t,o,s,r,d,u,c,m,_;return[(0,a._)("div",E,[(0,a._)("div",L,[N,(0,a._)("div",B,(0,i.zw)((0,n.SU)(v).unitFormat((null===(e=x.value)||void 0===e||null===(t=e.usage)||void 0===t?void 0:t.average_usage)||0,null===(o=x.value)||void 0===o||null===(s=o.meter_details)||void 0===s?void 0:s.meter_type_id)),1)]),(0,a.Wm)(_e,{vertical:""}),(0,a._)("div",P,[V,(0,a._)("div",J,(0,i.zw)((0,n.SU)(v).unitFormat((null===(r=x.value)||void 0===r||null===(d=r.usage)||void 0===d?void 0:d.predictive_monthly_usage)||0,null===(u=x.value)||void 0===u||null===(c=u.meter_details)||void 0===c?void 0:c.meter_type_id)),1)]),(0,a.Wm)(_e,{vertical:""}),(0,a._)("div",G,[X,(0,a._)("div",ee," R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(m=x.value)||void 0===m||null===(_=m.data)||void 0===_?void 0:_.daily_predictive_cost)||0)),1)])]),(0,a.Wm)(_e,{class:"q-mt-lg"})]})),_:1})):(0,a.kq)("",!0),(null===(m=x.value)||void 0===m||null===(q=m.meter_details)||void 0===q?void 0:q.meter_type_id)===(0,n.SU)(u.w)?((0,a.wg)(),(0,a.j4)(me,{key:2,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(pe,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,t,o,s,r,d,u,c;return[(0,a.Wm)(ge,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(we,{class:"item-styling"},{default:(0,a.w5)((()=>[te])),_:1}),(0,a.Wm)(we,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>{var e,t,o;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(e=x.value)||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.water_in)||void 0===o?void 0:o.predictive.total)||0)),1)]})),_:1})])),_:1}),(0,a.Wm)(ge,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(we,{class:"item-styling"},{default:(0,a.w5)((()=>[le])),_:1}),(0,a.Wm)(we,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>{var e,t,o;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(e=x.value)||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.water_out)||void 0===o?void 0:o.predictive.total)||0)),1)]})),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=x.value)||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.water_in)||void 0===o||null===(s=o.predictive)||void 0===s?void 0:s.additional_costs)||[],((e,t)=>((0,a.wg)(),(0,a.j4)(ge,{class:"item-style",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(we,{class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(we,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(r=x.value)||void 0===r||null===(d=r.data)||void 0===d||null===(u=d.water_out)||void 0===u||null===(c=u.predictive)||void 0===c?void 0:c.additional_costs)||[],((e,t)=>((0,a.wg)(),(0,a.j4)(ge,{class:"item-style",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(we,{class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(we,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),(0,a.Wm)(ge,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(we,{class:"item-styling"},{default:(0,a.w5)((()=>[ae])),_:1}),(0,a.Wm)(we,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>{var e,t;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(e=x.value)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.vat_predictive)||0)),1)]})),_:1})])),_:1})]})),_:1})])),_:1})):(null===(C=x.value)||void 0===C||null===(z=C.meter_details)||void 0===z?void 0:z.meter_type_id)===(0,n.SU)(u.E)?((0,a.wg)(),(0,a.j4)(me,{key:3,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(pe,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,t,o,s;return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=x.value)||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.electricity)||void 0===o||null===(s=o.predictive)||void 0===s?void 0:s.additional_costs)||[],((e,t)=>((0,a.wg)(),(0,a.j4)(ge,{class:"item-style",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(we,{class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(we,{side:"",class:"item-styling"},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128))]})),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(me,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,t;return[(0,a._)("div",ie,[ne,(0,a._)("span",oe,"R "+(0,i.zw)((0,n.SU)(l).numberFormat((null===(e=x.value)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.predictive)||0)),1)])]})),_:1}),(0,a.Wm)(me,{flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a._)("div",se,[(0,a.Wm)(S,{color:"primary",style:{width:"100%"},onClick:o[1]||(o[1]=e=>(0,n.SU)(U).mailCost(x.value))},{default:(0,a.w5)((()=>[re])),_:1})])])),_:1})],64))],64)}}};var ue=l(1639),ce=l(6602),me=l(1663),ve=l(8879),_e=l(1973),we=l(4458),ge=l(2857),pe=l(7128),ye=l(926),fe=l(3246),be=l(490),ke=l(1233),he=l(9984),xe=l.n(he);const We=(0,ue.Z)(de,[["__scopeId","data-v-45364f03"]]),Ue=We;xe()(de,"components",{QHeader:ce.Z,QToolbar:me.Z,QBtn:ve.Z,QToolbarTitle:_e.Z,QCard:we.Z,QIcon:ge.Z,QBanner:pe.Z,QSeparator:ye.Z,QList:fe.Z,QItem:be.Z,QItemSection:ke.Z})}}]);