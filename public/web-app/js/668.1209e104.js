"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[668],{7668:(e,l,t)=>{t.r(l),t.d(l,{default:()=>me});t(8964);var a=t(9835),i=t(6970),s=t(499),u=t(8339),n=t(1569);const o=(e,l)=>n.api.get(`/v1/meters/${e}/cost-estimation`,{params:{month:l}}),d=new Intl.NumberFormat("en-US",{style:"decimal"}),r=()=>({numberFormat(e){return"number"!==typeof e?e:d.format(e)}}),v=1,m=2,c=new Intl.NumberFormat("en-US"),_=()=>({unitFormat(e,l){return console.log(l),"number"!==typeof e?e:l===v?`${c.format(e)} kL`:l===m?`${c.format(e)} kWh`:void 0},klToLitters(e){return"number"!==typeof e?e:`${c.format(1e3*e)} L`}}),w=e=>((0,a.dD)("data-v-98c62b1c"),e=e(),(0,a.Cn)(),e),y={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},p={class:"large-text"},f={class:"medium-text"},g={class:"medium-text"},b={class:"medium-text"},k={key:0,class:"q-ma-sm q-pa-sm",style:{display:"flex","justify-content":"center","align-items":"center","min-height":"300px"}},h={class:"row flex justify-between items-center"},q={class:"column col-3"},U=w((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),x={class:"text-center basic-text"},W={class:"column col-3"},z=w((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),S={class:"text-center basic-text"},j={class:"column col-3"},F=w((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),D={class:"basic-text text-center"},Z={class:"row flex justify-between items-center"},C={class:"column col-3"},Q=w((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),H={class:"text-center basic-text"},R={class:"column col-3"},T=w((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),I={class:"text-center basic-text"},L={class:"column col-3"},M=w((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),Y={class:"basic-text text-center"},$=(0,a.Uk)("Water in"),K=(0,a.Uk)("Water out"),B=(0,a.Uk)("VAT"),N={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},P=w((()=>(0,a._)("span",{class:"large-text"},"Monthly Projected Cost",-1))),A={class:"large-text"},E={class:"flex column items-center q-pt-lg","aria-label":"heading"},V=(0,a.Uk)("Email Details"),G={__name:"MeterCost",setup(e){const l=(0,u.yj)(),t=(0,u.tv)(),n=r(),d=_(),c=(0,s.iH)({}),w=(0,s.iH)(!1);let G=l.query.month;G<0&&t.replace({...l,query:{...l.query,month:1}});const J=(0,s.iH)(l.query.month||1);function O(){var e;null!==(e=c.value)&&void 0!==e&&e.has_history&&(J.value++,t.push({...l,query:{...l.query,month:J.value}}))}function X(){J.value--,t.push({...l,query:{...l.query,month:J.value}})}async function ee(){try{c.value=await o(l.params.id,J.value),w.value=!1}catch(e){w.value=!0,c.value=e.response.data}}return(0,a.m0)((async()=>{J.value=l.query.month||1,await ee()})),(0,a.bv)((()=>{ee().then()})),(e,t)=>{var u,o,r,_,G,ee,le,te;const ae=(0,a.up)("q-btn"),ie=(0,a.up)("q-toolbar-title"),se=(0,a.up)("q-toolbar"),ue=(0,a.up)("q-header"),ne=(0,a.up)("q-icon"),oe=(0,a.up)("q-card"),de=(0,a.up)("q-banner"),re=(0,a.up)("q-separator"),ve=(0,a.up)("q-item-section"),me=(0,a.up)("q-item"),ce=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(ue,{elevated:"",class:"containerWidth new-meter-heading breadcrumbs"},{default:(0,a.w5)((()=>[(0,a.Wm)(se,null,{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{onClick:t[0]||(t[0]=l=>e.$router.back()),flat:"",dense:"",round:"",icon:"arrow_back","text-color":"white"}),(0,a.Wm)(ie,{class:"text-white"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)((0,s.SU)(l).meta.title),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(oe,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l,t,s,u;return[(0,a._)("div",y,[(0,a._)("span",p,"Meter# "+(0,i.zw)(null===(e=c.value)||void 0===e||null===(l=e.meter_details)||void 0===l?void 0:l.meter_number),1),(0,a._)("div",f,[null!==(t=c.value)&&void 0!==t&&t.has_history?((0,a.wg)(),(0,a.j4)(ne,{key:0,onClick:O,name:"arrow_left",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(ne,{key:1,disabled:"",name:"arrow_left",class:"icon-styling"})),(0,a._)("span",null," Projected bill for "+(0,i.zw)(null===(s=c.value)||void 0===s?void 0:s.month),1),J.value>1?((0,a.wg)(),(0,a.j4)(ne,{key:2,onClick:X,name:"arrow_right",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(ne,{key:3,disabled:"",name:"arrow_right",class:"icon-styling"}))]),(0,a._)("span",g,(0,i.zw)(null===(u=c.value)||void 0===u?void 0:u.cycle),1),(0,a._)("span",b,"Today is "+(0,i.zw)(c.value.current_date),1)])]})),_:1}),w.value?((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(de,{dense:"","inline-actions":"",class:"text-white bg-red"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(c.value.message),1)])),_:1})])):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(null===(u=c.value)||void 0===u||null===(o=u.meter_details)||void 0===o?void 0:o.meter_type_id)===(0,s.SU)(v)?((0,a.wg)(),(0,a.j4)(oe,{key:0,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l,t,u,o,r,v,m;return[(0,a._)("div",h,[(0,a._)("div",q,[U,(0,a._)("div",x,(0,i.zw)((0,s.SU)(d).klToLitters((null===(e=c.value)||void 0===e||null===(l=e.usage)||void 0===l?void 0:l.average_usage)||0)),1)]),(0,a.Wm)(re,{vertical:""}),(0,a._)("div",W,[z,(0,a._)("div",S,(0,i.zw)((0,s.SU)(d).unitFormat((null===(t=c.value)||void 0===t||null===(u=t.usage)||void 0===u?void 0:u.predictive_monthly_usage)||0,null===(o=c.value)||void 0===o||null===(r=o.meter_details)||void 0===r?void 0:r.meter_type_id)),1)]),(0,a.Wm)(re,{vertical:""}),(0,a._)("div",j,[F,(0,a._)("div",D," R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===(v=c.value)||void 0===v||null===(m=v.data)||void 0===m?void 0:m.daily_predictive_cost)||0)),1)])]),(0,a.Wm)(re,{class:"q-mt-lg"})]})),_:1})):(null===(r=c.value)||void 0===r||null===(_=r.meter_details)||void 0===_?void 0:_.meter_type_id)===(0,s.SU)(m)?((0,a.wg)(),(0,a.j4)(oe,{key:1,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l,t,u,o,r,v,m,_,w;return[(0,a._)("div",Z,[(0,a._)("div",C,[Q,(0,a._)("div",H,(0,i.zw)((0,s.SU)(d).unitFormat((null===(e=c.value)||void 0===e||null===(l=e.usage)||void 0===l?void 0:l.average_usage)||0,null===(t=c.value)||void 0===t||null===(u=t.meter_details)||void 0===u?void 0:u.meter_type_id)),1)]),(0,a.Wm)(re,{vertical:""}),(0,a._)("div",R,[T,(0,a._)("div",I,(0,i.zw)((0,s.SU)(d).unitFormat((null===(o=c.value)||void 0===o||null===(r=o.usage)||void 0===r?void 0:r.predictive_monthly_usage)||0,null===(v=c.value)||void 0===v||null===(m=v.meter_details)||void 0===m?void 0:m.meter_type_id)),1)]),(0,a.Wm)(re,{vertical:""}),(0,a._)("div",L,[M,(0,a._)("div",Y," R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===(_=c.value)||void 0===_||null===(w=_.data)||void 0===w?void 0:w.daily_predictive_cost)||0)),1)])]),(0,a.Wm)(re,{class:"q-mt-lg"})]})),_:1})):(0,a.kq)("",!0),(null===(G=c.value)||void 0===G||null===(ee=G.meter_details)||void 0===ee?void 0:ee.meter_type_id)===(0,s.SU)(v)?((0,a.wg)(),(0,a.j4)(oe,{key:2,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,l,t,u,o,d,r,v;return[(0,a.Wm)(me,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[$])),_:1}),(0,a.Wm)(ve,{side:""},{default:(0,a.w5)((()=>{var e,l,t;return[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===(e=c.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.water_in)||void 0===t?void 0:t.predictive.total)||0)),1)]})),_:1})])),_:1}),(0,a.Wm)(me,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[K])),_:1}),(0,a.Wm)(ve,{side:""},{default:(0,a.w5)((()=>{var e,l,t;return[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===(e=c.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.water_out)||void 0===t?void 0:t.predictive.total)||0)),1)]})),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=c.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.water_in)||void 0===t||null===(u=t.predictive)||void 0===u?void 0:u.additional_costs)||[],((e,l)=>((0,a.wg)(),(0,a.j4)(me,{class:"item-style",key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ve,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(o=c.value)||void 0===o||null===(d=o.data)||void 0===d||null===(r=d.water_out)||void 0===r||null===(v=r.predictive)||void 0===v?void 0:v.additional_costs)||[],((e,l)=>((0,a.wg)(),(0,a.j4)(me,{class:"item-style",key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ve,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),(0,a.Wm)(me,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[B])),_:1}),(0,a.Wm)(ve,{side:""},{default:(0,a.w5)((()=>{var e,l;return[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===(e=c.value)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.vat_predictive)||0)),1)]})),_:1})])),_:1})]})),_:1})])),_:1})):(null===(le=c.value)||void 0===le||null===(te=le.meter_details)||void 0===te?void 0:te.meter_type_id)===(0,s.SU)(m)?((0,a.wg)(),(0,a.j4)(oe,{key:3,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ce,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,l,t,u;return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=c.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.electricity)||void 0===t||null===(u=t.predictive)||void 0===u?void 0:u.additional_costs)||[],((e,l)=>((0,a.wg)(),(0,a.j4)(me,{class:"item-style",key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ve,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128))]})),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(oe,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l;return[(0,a._)("div",N,[P,(0,a._)("span",A,"R "+(0,i.zw)((0,s.SU)(n).numberFormat((null===(e=c.value)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.predictive)||0)),1)])]})),_:1}),(0,a.Wm)(oe,{flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a._)("div",E,[(0,a.Wm)(ae,{color:"primary",style:{width:"100%"}},{default:(0,a.w5)((()=>[V])),_:1})])])),_:1})],64))],64)}}};var J=t(1639),O=t(6602),X=t(1663),ee=t(8879),le=t(1973),te=t(4458),ae=t(2857),ie=t(7128),se=t(926),ue=t(3246),ne=t(490),oe=t(1233),de=t(9984),re=t.n(de);const ve=(0,J.Z)(G,[["__scopeId","data-v-98c62b1c"]]),me=ve;re()(G,"components",{QHeader:O.Z,QToolbar:X.Z,QBtn:ee.Z,QToolbarTitle:le.Z,QCard:te.Z,QIcon:ae.Z,QBanner:ie.Z,QSeparator:se.Z,QList:ue.Z,QItem:ne.Z,QItemSection:oe.Z})}}]);