"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[668],{7668:(e,l,t)=>{t.r(l),t.d(l,{default:()=>re});t(8964);var a=t(9835),i=t(6970),n=t(499),u=t(8339),s=t(1569);const r=(e,l)=>s.api.get(`/v1/meters/${e}/cost-estimation`,{params:{month:l}}),o=new Intl.NumberFormat("en-US",{style:"decimal"}),d=()=>({numberFormat(e){return"number"!==typeof e?e:o.format(e)}}),m=new Intl.NumberFormat("en-US"),v=()=>({unitFormat(e){return"number"!==typeof e?e:`${m.format(e)} kL`},klToLitters(e){return"number"!==typeof e?e:`${m.format(1e3*e)} L`}}),c=1,_=1,w=e=>((0,a.dD)("data-v-f4289674"),e=e(),(0,a.Cn)(),e),f={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},y={class:"large-text"},p={class:"medium-text"},g={class:"medium-text"},b={class:"medium-text"},k={key:0,class:"q-ma-sm q-pa-sm",style:{display:"flex","justify-content":"center","align-items":"center","min-height":"300px"}},h={class:"row flex justify-between items-center"},q={class:"column col-3"},U=w((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),W={class:"text-center basic-text"},x={class:"text-center basic-text"},z={class:"column col-3"},S=w((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),F={class:"text-center basic-text"},j={class:"text-center basic-text"},Z={class:"column col-3"},D=w((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),Q={style:{"margin-bottom":"22px"},class:"basic-text text-center"},T=(0,a.Uk)("Water in"),C=(0,a.Uk)("Water out"),R=(0,a.Uk)("VAT"),H=(0,a.Uk)("VAT"),I={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},L=w((()=>(0,a._)("span",{class:"large-text"},"Monthly Projected Cost",-1))),Y={class:"large-text"},M={style:{"flex-direction":"column"},class:"flex column items-center","aria-label":"heading"},$={class:"large-text"},K={class:"large-text"},A={class:"flex column items-center q-pt-lg","aria-label":"heading"},B=(0,a.Uk)("Email Details"),N={__name:"MeterCost",setup(e){const l=(0,u.yj)(),t=(0,u.tv)(),s=d(),o=v(),m=(0,n.iH)({}),w=(0,n.iH)(!1);let N=l.query.month;N<0&&t.replace({...l,query:{...l.query,month:1}});const P=(0,n.iH)(l.query.month||1);function V(){var e;null!==(e=m.value)&&void 0!==e&&e.has_history&&(P.value++,t.push({...l,query:{...l.query,month:P.value}}))}function E(){P.value--,t.push({...l,query:{...l.query,month:P.value}})}async function G(){try{m.value=await r(l.params.id,P.value),w.value=!1}catch(e){w.value=!0,m.value=e.response.data}}return(0,a.m0)((async()=>{P.value=l.query.month||1,await G()})),(0,a.bv)((()=>{G().then()})),(e,t)=>{var u,r,d,v;const N=(0,a.up)("q-btn"),G=(0,a.up)("q-toolbar-title"),J=(0,a.up)("q-toolbar"),O=(0,a.up)("q-header"),X=(0,a.up)("q-icon"),ee=(0,a.up)("q-card"),le=(0,a.up)("q-banner"),te=(0,a.up)("q-separator"),ae=(0,a.up)("q-item-section"),ie=(0,a.up)("q-item"),ne=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(O,{elevated:"",class:"containerWidth new-meter-heading breadcrumbs"},{default:(0,a.w5)((()=>[(0,a.Wm)(J,null,{default:(0,a.w5)((()=>[(0,a.Wm)(N,{onClick:t[0]||(t[0]=l=>e.$router.back()),flat:"",dense:"",round:"",icon:"arrow_back","text-color":"white"}),(0,a.Wm)(G,{class:"text-white"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)((0,n.SU)(l).meta.title),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(ee,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l,t,n,u;return[(0,a._)("div",f,[(0,a._)("span",y,"Meter# "+(0,i.zw)(null===(e=m.value)||void 0===e||null===(l=e.meter_details)||void 0===l?void 0:l.meter_number),1),(0,a._)("div",p,[null!==(t=m.value)&&void 0!==t&&t.has_history?((0,a.wg)(),(0,a.j4)(X,{key:0,onClick:V,name:"arrow_left",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(X,{key:1,disabled:"",name:"arrow_left",class:"icon-styling"})),(0,a._)("span",null," Projected bill for "+(0,i.zw)(null===(n=m.value)||void 0===n?void 0:n.month),1),P.value>1?((0,a.wg)(),(0,a.j4)(X,{key:2,onClick:E,name:"arrow_right",class:"icon-styling"})):((0,a.wg)(),(0,a.j4)(X,{key:3,disabled:"",name:"arrow_right",class:"icon-styling"}))]),(0,a._)("span",g,(0,i.zw)(null===(u=m.value)||void 0===u?void 0:u.cycle),1),(0,a._)("span",b,"Today is "+(0,i.zw)(m.value.current_date),1)])]})),_:1}),w.value?((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(le,{dense:"","inline-actions":"",class:"text-white bg-red"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(m.value.message),1)])),_:1})])):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Wm)(ee,{flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l,t,u,r,d,v,c,_,w;return[(0,a._)("div",h,[(0,a._)("div",q,[U,(0,a._)("div",W,(0,i.zw)((0,n.SU)(o).unitFormat((null===(e=m.value)||void 0===e||null===(l=e.usage)||void 0===l?void 0:l.average_usage)||0)),1),(0,a._)("div",x,(0,i.zw)((0,n.SU)(o).klToLitters((null===(t=m.value)||void 0===t||null===(u=t.usage)||void 0===u?void 0:u.average_usage)||0)),1)]),(0,a.Wm)(te,{vertical:""}),(0,a._)("div",z,[S,(0,a._)("div",F,(0,i.zw)((0,n.SU)(o).unitFormat((null===(r=m.value)||void 0===r||null===(d=r.usage)||void 0===d?void 0:d.predictive_monthly_usage)||0)),1),(0,a._)("div",j,(0,i.zw)((0,n.SU)(o).klToLitters((null===(v=m.value)||void 0===v||null===(c=v.usage)||void 0===c?void 0:c.predictive_monthly_usage)||0)),1)]),(0,a.Wm)(te,{vertical:""}),(0,a._)("div",Z,[D,(0,a._)("div",Q," R "+(0,i.zw)((0,n.SU)(s).numberFormat(0|(null===(_=m.value)||void 0===_||null===(w=_.data)||void 0===w?void 0:w.daily_predictive_cost))),1)])]),(0,a.Wm)(te,{class:"q-mt-lg"})]})),_:1}),(null===(u=m.value)||void 0===u||null===(r=u.meter_details)||void 0===r?void 0:r.meter_type_id)===(0,n.SU)(c)?((0,a.wg)(),(0,a.j4)(ee,{key:0,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ne,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,l,t,u,r,o,d,v;return[(0,a.Wm)(ie,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[T])),_:1}),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>{var e,l,t;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.water_in)||void 0===t?void 0:t.predictive.total)||0)),1)]})),_:1})])),_:1}),(0,a.Wm)(ie,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[C])),_:1}),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>{var e,l,t;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.water_out)||void 0===t?void 0:t.predictive.total)||0)),1)]})),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.water_in)||void 0===t||null===(u=t.predictive)||void 0===u?void 0:u.additional_costs)||[],((e,l)=>((0,a.wg)(),(0,a.j4)(ie,{class:"item-style",key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(r=m.value)||void 0===r||null===(o=r.data)||void 0===o||null===(d=o.water_out)||void 0===d||null===(v=d.predictive)||void 0===v?void 0:v.additional_costs)||[],((e,l)=>((0,a.wg)(),(0,a.j4)(ie,{class:"item-style",key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),(0,a.Wm)(ie,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[R])),_:1}),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>{var e,l;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.vat_predictive)||0)),1)]})),_:1})])),_:1})]})),_:1})])),_:1})):(null===(d=m.value)||void 0===d||null===(v=d.meter_details)||void 0===v?void 0:v.meter_type_id)===(0,n.SU)(_)?((0,a.wg)(),(0,a.j4)(ee,{key:1,flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ne,{bordered:"",separator:""},{default:(0,a.w5)((()=>{var e,l,t,u;return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.electricity)||void 0===t||null===(u=t.predictive)||void 0===u?void 0:u.additional_costs)||[],((e,l)=>((0,a.wg)(),(0,a.j4)(ie,{class:"item-style",key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title),1)])),_:2},1024),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===e||void 0===e?void 0:e.cost)||0)),1)])),_:2},1024)])),_:2},1024)))),128)),(0,a.Wm)(ie,{class:"item-style"},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[H])),_:1}),(0,a.Wm)(ae,{side:""},{default:(0,a.w5)((()=>{var e,l;return[(0,a.Uk)("R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.vat_predictive)||0)),1)]})),_:1})])),_:1})]})),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(ee,{flat:"",class:"bg-grey-4 q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l;return[(0,a._)("div",I,[L,(0,a._)("span",Y,"R "+(0,i.zw)((0,n.SU)(s).numberFormat((null===(e=m.value)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.predictive)||0)),1)])]})),_:1}),(0,a.Wm)(ee,{flat:"",class:"q-ma-sm q-pa-sm"},{default:(0,a.w5)((()=>{var e,l,t;return[(0,a._)("div",M,[(0,a._)("span",$,"Dated: "+(0,i.zw)(null===(e=m.value)||void 0===e?void 0:e.current_date),1),(0,a._)("span",K,"Reading: "+(0,i.zw)(null===(l=m.value)||void 0===l||null===(t=l.usage)||void 0===t?void 0:t.reading),1)]),(0,a._)("div",A,[(0,a.Wm)(N,{color:"primary",style:{width:"100%"}},{default:(0,a.w5)((()=>[B])),_:1})])]})),_:1})],64))],64)}}};var P=t(1639),V=t(6602),E=t(1663),G=t(8879),J=t(1973),O=t(4458),X=t(2857),ee=t(7128),le=t(926),te=t(3246),ae=t(490),ie=t(1233),ne=t(9984),ue=t.n(ne);const se=(0,P.Z)(N,[["__scopeId","data-v-f4289674"]]),re=se;ue()(N,"components",{QHeader:V.Z,QToolbar:E.Z,QBtn:G.Z,QToolbarTitle:J.Z,QCard:O.Z,QIcon:X.Z,QBanner:ee.Z,QSeparator:le.Z,QList:te.Z,QItem:ae.Z,QItemSection:ie.Z})}}]);