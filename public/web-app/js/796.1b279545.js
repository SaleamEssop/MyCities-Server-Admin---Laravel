(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[796],{6094:(e,t,l)=>{"use strict";l.d(t,{z:()=>o});var a=l(1448);const i=new Intl.NumberFormat("en-US"),o=()=>{function e(e){const t=e.toString(),l=t.split("."),a=l[0].padStart(4,"0"),i=l[1]||"";return`${a}.${i}`}function t(e){const t=e.toString(),l=t.split("."),a=l[0].padStart(5,"0"),i=l[1]||"";return`${a}.${i}`}return{unitFormat(l,i,o=!1){return"number"!==typeof l?l:i===a.w?o?`${e(l.toFixed(2))} kL`:`${l.toFixed(2)} kL`:i===a.E?o?(console.log(l),`${t(l.toFixed(1))} kWh`):`${l.toFixed(2)} kWh`:void 0},klToLitters(e){return"number"!==typeof e?e:`${i.format(1e3*e)} L`}}}},1448:(e,t,l)=>{"use strict";l.d(t,{E:()=>i,w:()=>a});const a=1,i=2},7727:(e,t,l)=>{"use strict";l.d(t,{a:()=>o});var a=l(3746),i=l(1569);const o=(0,a.Q_)("dataStore",{state:()=>({allData:{property:{property_name:"Loading...",property_address:"Loading...",property_manager:"Loading..."}}}),actions:{async fetchAllData(){try{let{data:e}=await(0,i.getAllData)();this.allData=e||{property:{property_name:"",property_address:"",property_manager:""}},console.log("Fetched Data:",this.allData)}catch(e){console.error("Error fetching data:",e)}}}})},5796:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>Di});var a=l(9835),i=l(499),o=l(6970),n=l(1957),r=l(9880),d=l.n(r),s=l(7208),u=l(6190),c=l(9428),m=l(6144);const v=e=>((0,a.dD)("data-v-da5aa3d2"),e=e(),(0,a.Cn)(),e),g={class:"flex justify-between items-center"},p={class:"text-bold text-h6 text-black"},w={class:"flex justify-between items-center"},_=(0,a.Uk)("Last reading, "),y={class:"q-mt-md"},f=v((()=>(0,a._)("div",{class:"flex justify-between items-center wrap"},null,-1))),h={class:"flex justify-between items-center"},b=v((()=>(0,a._)("p",{class:"q-mx-md"},null,-1))),M=(0,a.Uk)("Enter Reading"),D=(0,a.Uk)(" Â  "),k=(0,a.Uk)("Calculate Cost"),A=(0,a.Uk)("Enter New Reading"),C=(0,a.Uk)("Edit last reading"),x=(0,a.Uk)("Account Summary"),S=(0,a.Uk)("Calculate Cost"),I=(0,a.Uk)("Add a new meter"),Z=(0,a.Uk)("Delete Meter");function Y(e,t,l,i,n,r){const d=(0,a.up)("q-card-section"),s=(0,a.up)("MeterComponent"),u=(0,a.up)("q-btn"),c=(0,a.up)("router-link"),m=(0,a.up)("q-item-section"),v=(0,a.up)("q-item"),Y=(0,a.up)("q-list"),W=(0,a.up)("q-menu"),q=((0,a.up)("q-separator"),(0,a.up)("q-slide-transition"),(0,a.up)("q-card-actions"),(0,a.up)("q-card")),R=(0,a.up)("MeterComponentWithInput"),U=(0,a.up)("q-dialog"),E=(0,a.up)("AddMeter"),P=(0,a.up)("MeterCost"),V=(0,a.Q2)("close-popup"),F=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(q,{class:"no-shadow",dense:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"text-center q-py-none"},{default:(0,a.w5)((()=>{var t,l;return[(0,a._)("div",g,[(0,a._)("span",p,(0,o.zw)(null===(t=e.meter)||void 0===t?void 0:t.type.title)+" Meter :- "+(0,o.zw)(null===(l=e.meter)||void 0===l?void 0:l.number),1)]),(0,a._)("div",w,[(0,a._)("span",null,[_,(0,a._)("b",null,(0,o.zw)(new Date(e.lastReading.time).toLocaleDateString("en-GB")),1)])])]})),_:1}),(0,a.Wm)(d,{class:"q-pt-none text-center"},{default:(0,a.w5)((()=>{var t,l;return[(0,a._)("div",y,[f,(0,a.Wm)(s,{text:e.lastReading.valueInString,meterStyle:null===(t=e.meter)||void 0===t||null===(l=t.type)||void 0===l?void 0:l.id,readingType:2==e.meter.type.id?"electricity-recorded-reading":"water-recorded-reading"},null,8,["text","meterStyle","readingType"])])]})),_:1}),(0,a.Wm)(d,{class:"text-center"},{default:(0,a.w5)((()=>[(0,a._)("div",h,[b,(0,a._)("div",null,[(0,a.Wm)(u,{size:"0.7rem",rounded:"",color:"primary",onClick:t[0]||(t[0]=t=>{e.modelForReadingSet_NewReading=!0,e.modelForReadingSet=!0})},{default:(0,a.w5)((()=>[M])),_:1}),D,(0,a.Wm)(c,{class:"link",to:{name:"MeterCost",params:{id:e.meter.id}}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{size:"0.7rem",rounded:"",color:"primary"},{default:(0,a.w5)((()=>[k])),_:1})])),_:1},8,["to"])]),(0,a.Wm)(u,{flat:"",size:"lg",icon:"more_horiz","text-color":"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{anchor:"center middle",self:"center middle"},{default:(0,a.w5)((()=>[(0,a.Wm)(Y,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>{var l,i,o,n,r;return[(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{clickable:"",onClick:t[1]||(t[1]=t=>{e.modelForReadingSet_NewReading=!0,e.modelForReadingSet=!0})},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[A])),_:1})])),_:1})),[[V],[F]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{clickable:"",onClick:t[2]||(t[2]=t=>{e.modelForReadingSet_NewReading=!1,e.modelForReadingSet=!0})},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[C])),_:1})])),_:1})),[[V],[F]]),(0,a.Wm)(c,{class:"link",to:{name:"AccountSummary",params:{id:e.meter.id}}},{default:(0,a.w5)((()=>{var t,l;return[""!=(null===(t=e.store.allData.property)||void 0===t?void 0:t.property_name.trim())&&"Loading..."!=(null===(l=e.store.allData.property)||void 0===l?void 0:l.property_name.trim())?(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{key:0,clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[x])),_:1})])),_:1})),[[F]]):(0,a.kq)("",!0)]})),_:1},8,["to"]),(0,a.Wm)(c,{class:"link",to:{name:"MeterCost",params:{id:e.meter.id}}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[S])),_:1})])),_:1})),[[F]])])),_:1},8,["to"]),""===(null===(l=e.store.allData.property)||void 0===l?void 0:l.property_name.trim())&&"Loading..."!=(null===(i=e.store.allData.property)||void 0===i?void 0:i.property_name.trim())?(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{key:0,onClick:t[3]||(t[3]=t=>e.modelMeterForNewEdit=!0),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[I])),_:1})])),_:1})),[[V]]):(0,a.kq)("",!0),null!==(o=e.store)&&void 0!==o&&null!==(n=o.allData)&&void 0!==n&&null!==(r=n.property)&&void 0!==r&&r.property_name?(0,a.kq)("",!0):(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{key:1,clickable:"",onClick:t[4]||(t[4]=t=>e.deleteMeter(e.meter))},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Z])),_:1})])),_:1})),[[V]])]})),_:1})])),_:1})])),_:1})])])),_:1}),(0,a.kq)("",!0),(0,a.kq)("",!0),(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(U,{modelValue:e.modelForReadingSet,"onUpdate:modelValue":t[9]||(t[9]=t=>e.modelForReadingSet=t),onHide:t[10]||(t[10]=t=>e.modelForReadingSet=!1),persistent:"","full-width":!0},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{meter:e.meter,onClose:t[7]||(t[7]=t=>e.modelForReadingSet=!1),onSave:t[8]||(t[8]=t=>e.modelForReadingSet=!1),isNew:e.modelForReadingSet_NewReading},null,8,["meter","isNew"])])),_:1},8,["modelValue"]),(0,a.Wm)(U,{modelValue:e.modelMeterForNewEdit,"onUpdate:modelValue":t[13]||(t[13]=t=>e.modelMeterForNewEdit=t),onHide:t[14]||(t[14]=t=>e.modelMeterForNewEdit=!1),"full-width":!0,persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{propsMeter:null,propsAccount:e.selectedAccount,onClose:t[11]||(t[11]=t=>e.modelMeterForNewEdit=!1),onSave:t[12]||(t[12]=t=>e.modelMeterForNewEdit=!1)},null,8,["propsAccount"])])),_:1},8,["modelValue"]),(0,a.Wm)(U,{modelValue:e.modelCostForMeter,"onUpdate:modelValue":t[17]||(t[17]=t=>e.modelCostForMeter=t),onHide:t[18]||(t[18]=t=>e.modelCostForMeter=!1),"full-width":!0,persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(P,{meter:e.meter,meterCostData:e.meterCostData,onClose:t[15]||(t[15]=t=>e.modelCostForMeter=!1),onSave:t[16]||(t[16]=t=>e.modelCostForMeter=!1),isNew:!0},null,8,["meter","meterCostData"])])),_:1},8,["modelValue"])],64)}var W=l(8339),q=l(4170),R=(l(1530),l(9302));l(702);const U={class:"text-container"},E=["maxlength"];function P(e,t,l,i,r,d){return(0,a.wg)(),(0,a.iD)("div",{class:(0,o.C_)(["container-border",e.readingType])},[(0,a._)("div",U,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.chars,((t,l)=>((0,a.wg)(),(0,a.iD)("span",{key:l,class:"text-h4",style:(0,o.j5)(e.styles(l))},(0,o.zw)(t),5)))),128))]),e.isInput?(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:0,type:"text",class:"input-field","onUpdate:modelValue":t[0]||(t[0]=t=>e.inputValue=t),maxlength:e.meterStyleDigits,onInput:t[1]||(t[1]=(...t)=>e.handleInput&&e.handleInput(...t))},null,40,E)),[[n.nr,e.inputValue]]):(0,a.kq)("",!0)],2)}l(6727),l(8964);const V=[{color:"black",background:"white"},{color:"white",background:"#b30101"},{color:"white",background:"#666666"}],F=(0,a.aZ)({name:"MeterComponent",props:{text:String,meterStyle:Number,readingType:String,isInput:{type:Boolean,default:!1}},emits:["update:valueInString"],setup(e,{emit:t}){const l=(0,i.iH)(e.text||""),o=(0,a.Fl)((()=>1===e.meterStyle?8:6));(0,a.YP)((()=>e.text),(e=>{l.value=e||""}));const n=(0,a.Fl)((()=>{let t=l.value.toString().trim();t.includes(".")&&(t=t.replace(".",""));const a=[...t];let i=[];return a.length<o.value&&(i=[...new Array(o.value-a.length)].map((t=>e.isInput?"_":"0"))),[...a,...i]})),r=t=>{const l=n.value.length||0;switch(e.meterStyle){case 1:if(t>=l-4)return V[1];break;case 2:if(t>=l-1)return V[2];break}return V[0]},d=e=>{l.value=e.target.value.replace(/[^0-9]/g,""),t("update:valueInString",l.value)};function s(){return n.value.map((e=>"_"==e?0:e)).join("")}return{chars:n,styles:r,inputValue:l,handleInput:d,getValueInString:s,meterStyleDigits:o}}});var j=l(1639);const z=(0,j.Z)(F,[["render",P],["__scopeId","data-v-a896ecba"]]),H=z;var T=l(7594),Q=l(6889),N=l.n(Q);const B=e=>((0,a.dD)("data-v-1b967aea"),e=e(),(0,a.Cn)(),e),O={key:0,class:""},L={key:0,class:"q-mb-sm text-subtitle2","text-color":"negative",style:{color:"red"}},$={class:"row text-subtitle2"},K=B((()=>(0,a._)("div",{class:"col-7"},"Account Number",-1))),G={class:"col-5"},J=B((()=>(0,a._)("div",{class:"col-7"},"Meter Number",-1))),X={class:"col-5"},ee=B((()=>(0,a._)("div",{class:"col-7"},"Name on Account",-1))),te={class:"col-5"},le=B((()=>(0,a._)("div",{class:"col-7"},"Last reading",-1))),ae={class:"col-5"},ie=B((()=>(0,a._)("div",{class:"col-7"},"Last reading Date",-1))),oe={class:"col-5"},ne={class:"row selectDate"},re={class:"text-body1"},de={class:"q-pt-md justify-center col-5"},se={class:"round-cheap text-center"},ue=(0,a.Uk)("Select date "),ce={class:"row items-center justify-end q-gutter-sm"},me={class:"absolute",style:{opacity:"0"}},ve={class:"text-center"},ge=(0,a.Uk)("Cancel"),pe=(0,a.Uk)("Save"),we=B((()=>(0,a._)("div",{class:"text-subtitle1",style:{"margin-top":"-10px"}},"Powered by",-1))),_e=B((()=>(0,a._)("div",{style:{"margin-top":"15px"}},[(0,a._)("img",{class:"q-px-lg myCityIcon",src:N()})],-1)));function ye(e,t,l,i,r,d){const s=(0,a.up)("q-img"),u=(0,a.up)("q-separator"),c=(0,a.up)("q-badge"),m=(0,a.up)("q-btn"),v=(0,a.up)("q-date"),g=(0,a.up)("q-popup-proxy"),p=(0,a.up)("q-card-section"),w=(0,a.up)("q-input"),_=(0,a.up)("MeterComponent"),y=(0,a.up)("q-card-actions"),f=(0,a.up)("q-card"),h=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(f,{id:"cardId_12"},{default:(0,a.w5)((()=>[e.imageSrc?((0,a.wg)(),(0,a.iD)("div",O,[(0,a.Wm)(s,{src:e.imageSrc,class:"captureImage"},null,8,["src"]),(0,a.Wm)(u,{color:"grey",size:"6px"})])):(0,a.kq)("",!0),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>{var l,i,r,d;return[e.isNew?((0,a.wg)(),(0,a.iD)("div",L,(0,o.zw)(e.alertIfLessThen24Hours),1)):(0,a.kq)("",!0),(0,a._)("div",$,[K,(0,a._)("div",G,": "+(0,o.zw)(null===(l=e.account)||void 0===l?void 0:l.number),1),J,(0,a._)("div",X,": "+(0,o.zw)(e.meter?null===(i=e.meter)||void 0===i?void 0:i.number:""),1),ee,(0,a._)("div",te,": "+(0,o.zw)(null===(r=e.account)||void 0===r?void 0:r.title),1),le,(0,a._)("div",ae," : "+(0,o.zw)(e.unitFormat.unitFormat(null===(d=e.lastReadingItem)||void 0===d?void 0:d.value,e.meter.type.id,!0)),1),ie,(0,a._)("div",oe,": "+(0,o.zw)(e.lastreadingDate),1)]),(0,a.wy)((0,a._)("div",ne,[(0,a.Wm)(c,{class:"bg-white col-7","text-color":"black"},{default:(0,a.w5)((()=>[(0,a._)("span",re," Date: "+(0,o.zw)(e.readingDate),1)])),_:1}),(0,a.wy)((0,a._)("div",de,[(0,a._)("span",se,[ue,(0,a.Wm)(g,{onBeforeShow:e.updateProxy,cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{modelValue:e.readingDate,"onUpdate:modelValue":t[0]||(t[0]=t=>e.readingDate=t),mask:"DD-MMM-YYYY"},{default:(0,a.w5)((()=>[(0,a._)("div",ce,[(0,a.wy)((0,a.Wm)(m,{label:"Cancel",color:"primary",flat:""},null,512),[[h]]),(0,a.wy)((0,a.Wm)(m,{label:"Select",color:"primary",flat:"",onClick:e.save},null,8,["onClick"]),[[h]])])])),_:1},8,["modelValue"])])),_:1},8,["onBeforeShow"])])],512),[[n.F8,e.isNew]])],512),[[n.F8,e.isNew]])]})),_:1}),(0,a.Wm)(p,{style:{"margin-top":"-15px"}},{default:(0,a.w5)((()=>[(0,a._)("div",{class:(0,o.C_)(["relative",e.inputFocus?"stroke-focus":"stroke-simple"])},[(0,a._)("div",me,[(0,a.Wm)(w,{type:"number",color:"black",min:0,outlined:"",onFocus:t[1]||(t[1]=t=>e.inputFocus=!0),onBlur:t[2]||(t[2]=t=>e.inputFocus=!1),step:1,autofocus:"",modelValue:e.currentReading,"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentReading=t),oninput:"if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);",maxlength:2==e.meter.type.id?6:8,onKeypress:t[4]||(t[4]=t=>{(`${e.currentReading||""}`.length>=(2==e.meter.type.id?6:8)||46==t.keyCode)&&t.preventDefault()})},null,8,["modelValue","maxlength"])]),(0,a._)("div",ve,[(0,a.Wm)(_,{text:e.currentReading,ref:"meterComopnentReadValue",meterStyle:e.meter.type.id,readingType:2==e.meter.type.id?"electricity-recorded-reading":"water-recorded-reading",isInput:!0},null,8,["text","meterStyle","readingType"])])],2)])),_:1}),(0,a.Wm)(y,{align:"center",style:{"margin-top":"-10px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{icon:"image",color:"primary","text-color":"white",onClick:t[5]||(t[5]=t=>e.captureImage())}),(0,a.Wm)(m,{color:"primary","text-color":"white",onClick:t[6]||(t[6]=t=>e.$emit("close"))},{default:(0,a.w5)((()=>[ge])),_:1}),(0,a.Wm)(m,{color:"primary","text-color":"white",onClick:t[7]||(t[7]=t=>e.screenShotCapture())},{default:(0,a.w5)((()=>[pe])),_:1})])),_:1}),(0,a.Wm)(u,{color:"grey",size:"10px"}),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[we,_e,(0,a._)("div",{onClick:t[8]||(t[8]=t=>e.openWeb()),style:{"text-decoration":"underline"},class:"text-body1 text-center"}," www.mycities.co.za ")])),_:1}),(0,a.Wm)(u,{color:"grey",size:"4px"})])),_:1})}var fe=l(8761),he=l.n(fe);const be=class{constructor(){he()(this,"getSubmitedAndLastReading",((e,t,l)=>{const a="MMM YYYY",i=(e,t,l)=>{var a,i;let o=q.ZP.formatDate(new Date(t),"M"),n=(e||[]).map((e=>{if(3===o?l-2419e6:l-26298e5<=e.time&&e.time<=l)return e}));n=n.filter((function(e){return void 0!==e})),n=n.sort(((e,t)=>t.time-e.time));var r=(e||[]).map((e=>{if(l-52596e5<=e.time&&e.time<=l-26298e5)return e}));r=r.filter((function(e){return void 0!==e}));var d=(e||[]).map((e=>e));if(d=d.filter((function(e){return void 0!==e})),null!==(a=n)&&void 0!==a&&a.length)if(1===(null===(i=n)||void 0===i?void 0:i.length)){s=n[0]||{};if(0!==r.length)u=r[0]||{};else u=d[d.length-1]||{}}else s=n[0]||{},u=n[n.length-1]||{};else var s=d[0]||{},u=d[d.length-1]||{};return{firstReading:u,lastReading:s}};let o={},n={},r=q.ZP.addToDate(t,{days:l-1}),d=q.ZP.formatDate(r,"x");const s=q.ZP.formatDate(r,a);let u=24;do{let t=q.ZP.formatDate(q.ZP.subtractFromDate(r,{months:24-u}),a);const{firstReading:l,lastReading:s}=i(e,t,d);if(0===Object.keys(o).length&&Object.keys(s).length>0?(o=s,l.time!=s.time&&(n=l)):Object.keys(o).length>0&&0===Object.keys(n).length&&Object.keys(s).length>0&&o.time!=s.time&&(n=s),Object.keys(o).length>0&&Object.keys(n).length>0)break}while(--u>0);return{firstReading:n,lastReading:o,period:s}})),he()(this,"calculateUnitForMonth",(({isLastReadings:e,id:t})=>{const{lastReading:l,firstReading:a}=e;if(a.value>l.value&&l.time>a.time){let e=2===t?99999.9:9999.9999;var i=e+l.value-a.value}else i=l.value-a.value;var o=l.time-a.time;return 1e3*(i/o||0)*60*60*24})),he()(this,"getWaterMeterCost",(e=>{const t=30,l=t*e,a=[{min:0,max:200,ir:26.87,or:4.43,out:.95},{min:200,max:833,ir:31.83,or:7.48,out:.75},{min:833,max:1e3,ir:42.43,or:14.26,out:.75},{min:1e3,max:1500,ir:65.39,or:22.26,out:.65},{min:1500,max:Number.MAX_SAFE_INTEGER,ir:71.91,or:25.48,out:.65}].map((e=>({min:e.min,max:e.max,ir:e.ir,or:e.or,out:e.out}))),i=[{title:"Infrastructure Surcharge",amountPerUnit:1.48,amount:0},{title:"Sewage Disposal Charge",amountPerUnit:1.48,amount:0}],o=(e,t)=>{const l=a[e],i=Math.round(30*(l.max-l.min)/1e3),o=Math.min(i,t),n=o*l.out;return{conditionInputUses:o,conditionOutputUses:n,conditionInputRate:o*l["ir"],conditionOutputRate:n*l["or"],nextUnit:t-o}},n=new Array;let r=l,d=0;while(d<a.length){let e=o(d++,r);if(r=e.nextUnit,n.push(e),r<=0)break}const s=n.reduce(((e,t)=>(e["in"]["value"]+=t["conditionInputRate"],e["out"]["value"]+=t["conditionOutputRate"],e["in"]["reading"]+=t["conditionInputUses"],e["out"]["reading"]+=t["conditionOutputUses"],e)),{in:{title:"Water in",value:0,reading:0},out:{title:"Water Out",value:0,reading:0}}),u=[];Object.keys(s).forEach((e=>{u.push(s[e])})),i.forEach((e=>{u.push({title:e.title,value:e.amountPerUnit*("Sewage Disposal Charge"===e.title?s["out"]["reading"]:s["in"]["reading"])||e.amount})}));const c={};return c["projection"]=l>0?u:[],c["total"]=l>0?u.reduce(((e,{value:t})=>(e+=t,e)),0):0,c["readingCharges"]=n,c["extraCharges"]=i,c})),he()(this,"getElectricMeterCost",(e=>{const t=30,l=t*e,a={},i=[];return i.push({title:"Electricity bill",value:2.2425*l}),a["projection"]=i,a["total"]=i.reduce(((e,{value:t})=>(e+=t,e)),0),a})),he()(this,"getCost",((e,t)=>{var l,a;return 2==(null===t||void 0===t||null===(l=t.type)||void 0===l?void 0:l.id)?this.getElectricMeterCost(e):1==(null===t||void 0===t||null===(a=t.type)||void 0===a?void 0:a.id)?this.getWaterMeterCost(e):void 0})),he()(this,"timeDiffCalc",((e,t)=>{let l=Math.abs(e-t)/1e3;const a=Math.floor(l/86400);l-=86400*a;const i=Math.floor(l/3600)%24;l-=3600*i;const o=Math.floor(l/60)%60;l-=60*o;let n="";return a>0&&(n+=1===a?`${a} day, `:`${a} days, `),n+=0===i||1===i?`${i} hour, `:`${i} hours, `,n+=`${o} minutes`,n}))}};var Me=l(1569),De=l(7881),ke=l(5326),Ae=l.n(ke),Ce=l(6094);const{Camera:xe,Filesystem:Se}=De.Vn,Ie=(0,a.aZ)({name:"MeterComponentWithInput",props:{meter:Object,isNew:Boolean},setup(e,{emit:t}){const l=(0,Ce.z)(),o=(0,i.iH)(),n=(0,T.H)(),r=(0,u.c)(),d=((0,c.b)(),r.getAccountById(e.meter.account.id)),s=(0,i.iH)(q.ZP.formatDate(Date.now(),"DD/MM/YYYY")),m=(0,R.Z)(),v=e=>{m.notify({attrs:{role:"alertdialog"},message:e,actions:[{icon:"close","aria-label":"Dismiss"}]})},g=(0,i.iH)(q.ZP.formatDate(new Date,"DD-MMM-YYYY")),p=()=>{window.open("http://mycities.co.za/","_blank")},w=(0,i.iH)(""),_=async()=>{const e=await xe.getPhoto({quality:100,source:De.oK.Prompt,resultType:De.dk.Uri,direction:De.GW.Rear});var t=e.webPath;w.value=t,y("Please ensure that the entered reading matches the meter image reading")};function y(e){m.dialog({dark:!1,message:e,ok:"Confirm",color:"positive"})}async function f(){try{await Se.mkdir({path:"MyCityApp",directory:De.QT.Documents,recursive:!0})}catch(e){console.error("Unable to make directory",e)}}const h=()=>{var e=document.getElementById("cardId_12");Ae().toPng(e).then((function(e){var t=new Image;t.src=e;const l=t.src,a=q.ZP.formatDate(Date.now(),"YYYY_MM_DD_HH_mm_ss")+".jpeg";f();const i=Se.writeFile({path:"MyCityApp/"+a,data:l,directory:De.QT.Documents});console.log("savedFile",i),W(!1),m.notify({message:"Saved:-FileManager/Documents/MyCityApp/.."})})).catch((function(e){console.error("oops, something went wrong!",e)}))},b=e=>fetch(e).then((e=>e.blob())).then((e=>new Promise(((t,l)=>{const a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=l,a.readAsDataURL(e)})))),M=(0,i.iH)(!1),D=n.getReadingsByMeterId(e.meter.id),k=(0,i.iH)(D[0].time),A=(0,i.iH)();let C=(0,i.iH)(D[0]);const x=(0,i.iH)(q.ZP.formatDate(new Date(C.value.time),"DD-MMM-YYYY")),S=(0,i.iH)(C.value.valueInString);e.isNew||(C.value.isSubmit?v("Submitted reading can not update"):(C=(0,i.iH)(D[0]),S.value=D[0].valueInString||"",A.value=D[0]));const I=(0,a.Fl)((()=>{let e=q.ZP.extractDate(g.value,"DD-MMM-YYYY"),t=q.ZP.formatDate(e,"x");if(C.value.time>t)return" ";if(C.value.time+864e5>Date.now()){let e=Z.timeDiffCalc(C.value.time+864e5,Date.now());return`Your last entry was less than 24 hours ago. Please wait ${e}.`}return""})),Z=new be;function Y(e,t){m.dialog({title:"Confirm",message:`${e}`,cancel:!0,persistent:!0}).onOk((()=>{console.log(">>>> OK"),t()})).onCancel((()=>{console.log(">>>> Cancel")})).onDismiss((()=>{console.log("I am triggered on both OK and Cancel")}))}const W=(l=!1)=>{const a=(a,i)=>{b(w.value).then((o=>{const r=new Date(q.ZP.extractDate(g.value,"DD-MMM-YYYY")).toISOString();if(e.isNew)(0,Me.addReadingInMeter)({meter_id:e.meter.id,meter_reading_date:r,meter_reading:i,reading_image:o}).then((t=>{t.status?(n.addReading({id:t.data.id,value:a,valueInString:i,time:new Date(r).getTime(),isSubmit:l,meter:{id:e.meter.id}}),m.notify({message:t.msg||"Reading added successfully!",color:"positive"})):m.notify({message:t.msg||"Oops, something went wrong!",color:"negative"})})).catch((e=>{var t,l;m.notify({message:(null===(t=e.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.msg)||"An unexpected error occurred.",color:"negative"})}));else{let t=q.ZP.formatDate(new Date(k.value).toISOString());(0,Me.updateReadingInMeter)({meter_id:e.meter.id,meter_reading_date:t,meter_reading:i,meter_reading_id:A.value.id,reading_image:o}).then((o=>{o.status?(n.updateReading({id:A.value.id,value:a,valueInString:i,time:new Date(t).getTime(),isSubmit:l,meter:{id:e.meter.id}}),m.notify({message:o.msg||"Reading updated successfully!",color:"positive"})):m.notify({message:o.msg||"Oops, something went wrong!",color:"negative"})})).catch((e=>{var t,l;m.notify({message:(null===(t=e.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.msg)||"An unexpected error occurred.",color:"negative"})}))}t("save"),console.log("need to reload page")}))},i=o.value.getValueInString(),r=i/(2==e.meter.type.id?10:1e4);let d=q.ZP.extractDate(g.value,"DD-MMM-YYYY"),s=q.ZP.formatDate(d,"x"),u=q.ZP.formatDate(new Date,"x");if(e.isNew)if(C.value.time>s);else if(C.value.time+864e5>s){let e=Z.timeDiffCalc(C.value.time+864e5,Date.now());return void v(`Your last entry was less than 24 hours ago. Please wait ${e} before you read again.`)}if(u>s){var c=(D||[]).map((e=>{if(s>e.time)return e}));c=c.filter((function(e){return void 0!==e}));var p=(D||[]).map((e=>{if(s<e.time)return e}));p=p.filter((function(e){return void 0!==e}))}if(e.isNew&&(!r||r<C.value.value)&&C.value.time<s){e.meter.type.id;Y(`You have entered a value lower than the previous reading. Your usage is ${C.value.valueInString} to ${i}. Do you want to apply a rollover?.`,(()=>{(2==e.meter.type.id?C.value.valueInString-i>1e5:C.value.valueInString-i>1e6)?Y("You have entered a value which exceeds a usage of 100 000 or More. Shall we accept this reading?",(()=>{a(r,i)})):a(r,i)}))}else r>C.value.value&&(2==e.meter.type.id?i-C.value.valueInString>1e5:i-C.value.valueInString>1e6)?Y("You have entered a value which exceeds a usage of 100 000 or More. Shall we accept this reading?",(()=>{a(r,i)})):a(r,i)};return{unitFormat:l,account:d,inputFocus:M,currentReading:S,currentReadingItem:A,lastReadingItem:C,saveReading:W,meterComopnentReadValue:o,showAlert:v,alertIfLessThen24Hours:I,lastEditTime:k,imageSrc:w,currentDate:s,captureImage:_,screenShotCapture:h,openWeb:p,mkdir:f,readingDate:g,lastreadingDate:x,customalert:y}},components:{MeterComponent:H}});var Ze=l(4458),Ye=l(1487),We=l(926),qe=l(3190),Re=l(990),Ue=l(2765),Ee=l(7088),Pe=l(8879),Ve=l(6611),Fe=l(1821),je=l(2146),ze=l(9984),He=l.n(ze);const Te=(0,j.Z)(Ie,[["render",ye],["__scopeId","data-v-1b967aea"]]),Qe=Te;He()(Ie,"components",{QCard:Ze.Z,QImg:Ye.Z,QSeparator:We.Z,QCardSection:qe.Z,QBadge:Re.Z,QPopupProxy:Ue.Z,QDate:Ee.Z,QBtn:Pe.Z,QInput:Ve.Z,QCardActions:Fe.Z}),He()(Ie,"directives",{ClosePopup:je.Z});const Ne=e=>((0,a.dD)("data-v-40975110"),e=e(),(0,a.Cn)(),e),Be=Ne((()=>(0,a._)("div",{class:"text-subtitle2 text-white"},"Necessary Details",-1))),Oe=["src"],Le={key:0,class:""},$e=Ne((()=>(0,a._)("p",{class:"caption q-field__label q-mt-lg"},"Current Selected Dates",-1))),Ke={class:"flex justify-center items-center q-mt-lg reading-text-wrapper"},Ge={class:"row justify-center"},Je={class:"text-body1"},Xe={class:"justify-center flex"},et={class:"round-cheap-n text-center"},tt=(0,a.Uk)("Change "),lt={class:"row items-center justify-end q-gutter-sm"},at={class:"row justify-center q-mt-lg"},it=Ne((()=>(0,a._)("span",{class:"text-body1"},"Click to enter a reading",-1))),ot={class:"text-center"},nt={class:"absolute",style:{opacity:"0"}},rt={class:"text-center"};function dt(e,t,l,i,n,r){const d=(0,a.up)("q-card-section"),s=(0,a.up)("q-radio"),u=(0,a.up)("q-item-section"),c=(0,a.up)("q-avatar"),m=(0,a.up)("q-item-label"),v=(0,a.up)("q-item"),g=(0,a.up)("q-img"),p=(0,a.up)("q-separator"),w=(0,a.up)("q-list"),_=(0,a.up)("q-input"),y=(0,a.up)("q-badge"),f=(0,a.up)("q-btn"),h=(0,a.up)("q-date"),b=(0,a.up)("q-popup-proxy"),M=(0,a.up)("MeterComponent"),D=(0,a.up)("q-space"),k=(0,a.up)("q-card-actions"),A=(0,a.up)("q-card"),C=(0,a.Q2)("ripple"),x=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(A,{class:"modelHeight"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"bg-primary"},{default:(0,a.w5)((()=>[Be])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$METER_TYPES,(l=>(0,a.wy)(((0,a.wg)(),(0,a.j4)(v,{tag:"label",key:l.id},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.meter.type.id,"onUpdate:modelValue":t[0]||(t[0]=t=>e.meter.type.id=t),val:l.id},null,8,["modelValue","val"])])),_:2},1024),(0,a.Wm)(u,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a._)("img",{src:l.thumbnail},null,8,Oe)])),_:2},1024),(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.title),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)),[[C]]))),128)),e.imageSrc?((0,a.wg)(),(0,a.iD)("div",Le,[(0,a.Wm)(g,{src:e.imageSrc,class:"captureImage"},null,8,["src"]),(0,a.Wm)(p,{color:"grey",size:"6px"})])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{color:"black",type:"text",min:"0",modelValue:e.meter.title,"onUpdate:modelValue":t[1]||(t[1]=t=>e.meter.title=t),modelModifiers:{trim:!0},label:"Meter Description"},null,8,["modelValue"]),(0,a.Wm)(_,{color:"black",type:"text",min:"0",modelValue:e.meter.number,"onUpdate:modelValue":t[2]||(t[2]=t=>e.meter.number=t),modelModifiers:{trim:!0},label:"Meter Number"},null,8,["modelValue"]),$e,(0,a._)("div",Ke,[(0,a._)("div",Ge,[(0,a.Wm)(y,{class:"bg-white","text-color":"black"},{default:(0,a.w5)((()=>[(0,a._)("strong",Je,(0,o.zw)(e.readingDate),1)])),_:1})]),(0,a._)("div",Xe,[(0,a._)("span",et,[tt,(0,a.Wm)(b,{onBeforeShow:e.updateProxy,cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{modelValue:e.readingDate,"onUpdate:modelValue":t[3]||(t[3]=t=>e.readingDate=t),mask:"DD/MM/YYYY"},{default:(0,a.w5)((()=>[(0,a._)("div",lt,[(0,a.wy)((0,a.Wm)(f,{label:"Cancel",color:"primary",flat:""},null,512),[[x]]),(0,a.wy)((0,a.Wm)(f,{label:"OK",color:"primary",flat:"",onClick:e.save},null,8,["onClick"]),[[x]])])])),_:1},8,["modelValue"])])),_:1},8,["onBeforeShow"])])])]),(0,a.Wm)(p,{class:"q-mt-md"}),(0,a._)("div",at,[(0,a.Wm)(y,{class:"bg-grey-4","text-color":"black"},{default:(0,a.w5)((()=>[it])),_:1})]),(0,a._)("div",ot,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("div",{class:(0,o.C_)(["relative",e.inputFocus?"stroke-focus":"stroke-simple"])},[(0,a._)("div",nt,[(0,a.Wm)(_,{type:"number",color:"black",min:0,oninput:"if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);",maxlength:2==e.meter.type.id?6:8,outlined:"",onFocus:t[4]||(t[4]=t=>e.inputFocus=!0),onBlur:t[5]||(t[5]=t=>e.inputFocus=!1),step:1,modelValue:e.firstReading.valueInString,"onUpdate:modelValue":t[6]||(t[6]=t=>e.firstReading.valueInString=t),onKeypress:t[7]||(t[7]=t=>{(`${e.firstReading.valueInString||""}`.length>=(2==e.meter.type.id?6:8)||46==t.keyCode)&&t.preventDefault()})},null,8,["maxlength","modelValue"])]),(0,a._)("div",rt,[(0,a.Wm)(M,{ref:"meterComopnentReadValue",text:e.firstReading.valueInString,meterStyle:e.meter.type.id,readingType:2==e.meter.type.id?"electricity-recorded-reading":"water-recorded-reading",isInput:!0,"onUpdate:valueInString":e.updateValueInString},null,8,["text","meterStyle","readingType","onUpdate:valueInString"])])],2)])),_:1})])])),_:1}),(0,a.Wm)(D),(0,a.Wm)(k,{align:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{icon:"image",color:"primary","text-color":"white",onClick:t[8]||(t[8]=t=>e.captureImage())}),(0,a.Wm)(f,{color:"red","text-color":"white",class:"q-my-none q-mx-none",label:"Cancel",glossy:"",onClick:t[9]||(t[9]=t=>e.$emit("close"))}),(0,a.Wm)(f,{color:"primary","text-color":"white",class:"q-my-none q-mx-none",label:"Save",glossy:"",onClick:e.addMeter},null,8,["onClick"])])),_:1})])),_:1})}const{Camera:st,Filesystem:ut}=De.Vn,ct={isSubmit:!0,time:Date.now(),value:null,valueInString:"",meter:{id:null}},mt={id:null,title:null,number:null,type:{id:1},account:{id:null}},vt=(0,a.aZ)({name:"AccountComponent",props:{propsMeter:{type:Object,default:mt},autoUpdate:{type:Boolean,default:!1},propsAccount:{type:Object}},setup(e,{emit:t}){const l=(0,R.Z)(),a=(0,c.b)(),o=(0,T.H)(),n=(0,i.iH)(""),r=async()=>{try{const e=await st.getPhoto({quality:100,source:De.oK.Prompt,resultType:De.dk.Uri,direction:De.GW.Rear});n.value=e.webPath,d("Please ensure that the entered reading matches the meter image reading")}catch(e){console.error("Error capturing image:",e),l.notify({message:"Failed to capture image.",color:"negative"})}};function d(e){l.dialog({dark:!1,message:e,ok:"Confirm",color:"positive"})}function s(e){return new Promise(((t,l)=>{const a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=l,a.readAsDataURL(e)}))}const u=(0,i.iH)(e.propsMeter||JSON.parse(JSON.stringify(mt))),m=(0,i.iH)(),v=(0,i.iH)(JSON.parse(JSON.stringify(ct))),g=e=>{v.value.valueInString=e},p=async()=>{try{let i=null;if(n.value){const e=await fetch(n.value),t=await e.blob();i=await s(t)}if(null==u.value.id&&(u.value.id=Date.now(),u.value.account.id=e.propsAccount.id),v.value.meter.id=u.value.id,null==u.value.title||null==u.value.number)return void l.notify({message:"Fill all details before saving."});if(!v.value.valueInString||0===v.value.valueInString.replace(/_/g,"").length)return void l.notify({message:"You must enter a reading before saving even if it is all zeroes."});v.value.valueInString=m.value.getValueInString(),v.value.value=v.value.valueInString/(2==u.value.type.id?10:1e4);const r=await(0,Me.addMeterAndReading)({meter_type_id:u.value.type.id,meter_title:u.value.title,meter_number:u.value.number,meter_reading_image:i,meter_reading_date:new Date(v.value.time).toISOString(),meter_reading:v.value.valueInString,account_id:u.value.account.id});r.status&&(r.data.readings.forEach((e=>{o.addReading({id:e.id,meter:{id:e.meter_id},time:new Date(e.reading_date).getTime(),value:v.value.value,valueInString:e.reading_value})})),a.addMeter({account:{id:r.data.account_id},id:r.data.id,number:r.data.meter_number,title:r.data.meter_title,type:{id:r.data.meter_type_id}}),t("save"))}catch(i){console.error("Error saving meter:",i),l.notify({message:"Failed to save meter.",color:"negative"})}};return{meter:u,firstReading:v,meterComopnentReadValue:m,addMeter:p,captureImage:r,updateValueInString:g}},components:{MeterComponent:H}});var gt=l(3246),pt=l(490),wt=l(1233),_t=l(1480),yt=l(1357),ft=l(3115),ht=l(2857),bt=l(8149),Mt=l(136),Dt=l(1136);const kt=(0,j.Z)(vt,[["render",dt],["__scopeId","data-v-40975110"]]),At=kt;He()(vt,"components",{QCard:Ze.Z,QCardSection:qe.Z,QList:gt.Z,QItem:pt.Z,QItemSection:wt.Z,QRadio:_t.Z,QAvatar:yt.Z,QItemLabel:ft.Z,QImg:Ye.Z,QSeparator:We.Z,QInput:Ve.Z,QBtn:Pe.Z,QPopupProxy:Ue.Z,QDate:Ee.Z,QIcon:ht.Z,QField:bt.Z,QBadge:Re.Z,QSpace:Mt.Z,QCardActions:Fe.Z}),He()(vt,"directives",{Ripple:Dt.Z,ClosePopup:je.Z});const Ct=e=>((0,a.dD)("data-v-7a2a7428"),e=e(),(0,a.Cn)(),e),xt={key:0},St={class:"text-subtitle1"},It={class:"flex items-center"},Zt={class:"q-gutter-sm mx-3",style:{"font-size":"18px",margin:"0"}},Yt={class:"flex column content-center items-center"},Wt={class:"text-subtitle1 rounded-borders"},qt={class:"text-subtitle2"},Rt={class:"row flex justify-between items-center"},Ut={class:"column col-4"},Et=Ct((()=>(0,a._)("b",{class:"text-center"},"Daily Usage",-1))),Pt={class:"medium-rcorners text-h6 text-center",color:"negative","text-color":"white"},Vt={class:"column col-4"},Ft=Ct((()=>(0,a._)("b",{class:"text-center"},"Monthly Usage",-1))),jt={class:"medium-rcorners text-h6 text-center",color:"negative","text-color":"white"},zt={class:"column col-4"},Ht=Ct((()=>(0,a._)("b",{class:"text-center"},"Daily Cost",-1))),Tt={class:"medium-rcorners text-h6 text-center",color:"negative","text-color":"white"},Qt={key:0},Nt={class:"column flex justify-between items-center no-wrap q-mt-md"},Bt=Ct((()=>(0,a._)("b",null,"Monthly Projected cost",-1))),Ot={class:"big-rcorners text-h4 text-center",color:"negative","text-color":"white"},Lt={class:"text-center text-h6 q-mt-md"},$t={key:1},Kt=(0,a.Uk)("Email "),Gt=(0,a.Uk)("Close");function Jt(e,t,l,i,r,d){const s=(0,a.up)("q-icon"),u=(0,a.up)("q-card-section"),c=(0,a.up)("q-separator"),m=(0,a.up)("q-btn"),v=(0,a.up)("q-card-actions"),g=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(g,null,{default:(0,a.w5)((()=>{var l,i,r;return[0!=(null===(l=e.billingMeterCost)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.length)?((0,a.wg)(),(0,a.iD)("div",xt,[(0,a.Wm)(u,{class:"bg-grey-2 row justify-center"},{default:(0,a.w5)((()=>{var l;return[(0,a._)("div",St," Estimated Cost for Meter :- "+(0,o.zw)(null===(l=e.billingMeterCost)||void 0===l?void 0:l.meter_number),1),(0,a._)("div",It,[(0,a.Wm)(s,{name:"chevron_left",style:{"margin-top":"-5px"},size:"lg",class:"cursor-pointer",onClick:t[0]||(t[0]=t=>e.previousMonth(e.readingPeriod))}),(0,a._)("span",Zt," Projected bill for "+(0,o.zw)(e.readingPeriod),1),(0,a.Wm)(s,{style:{"margin-top":"-5px"},name:"chevron_right",size:"lg",class:"cursor-pointer",onClick:t[1]||(t[1]=t=>e.nextMonth(e.readingPeriod))})]),(0,a._)("div",Yt,[(0,a._)("div",Wt,(0,o.zw)(e.currentBillPeriod),1),(0,a._)("div",qt,"Current Date:- "+(0,o.zw)(e.currentDate),1)])]})),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>{var t,l,i,r,d,s;return[(0,a._)("div",null,[(0,a._)("div",Rt,[(0,a._)("div",Ut,[Et,(0,a._)("div",Pt,(0,o.zw)(null===(t=e.billingMeterCost)||void 0===t?void 0:t.daily_usage),1)]),(0,a._)("div",Vt,[Ft,(0,a._)("div",jt,(0,o.zw)(null===(l=e.billingMeterCost)||void 0===l?void 0:l.monthly_usage),1)]),(0,a._)("div",zt,[Ht,(0,a._)("div",Tt," R "+(0,o.zw)(null===(i=e.billingMeterCost)||void 0===i?void 0:i.daily_cost),1)])]),(0,a.Wm)(c,{class:"q-my-md",color:"grey",size:"2px"}),e.billingMeterCost?((0,a.wg)(),(0,a.iD)("div",Qt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.billingMeterCost["projection"],((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"row no-wrap",key:t},[(0,a.wy)((0,a._)("div",{class:"col"},(0,o.zw)(e.title),513),[[n.F8,e.title]]),(0,a.wy)((0,a._)("div",{class:"col-auto"},"R "+(0,o.zw)(e.total),513),[[n.F8,e.title]])])))),128))])):(0,a.kq)("",!0),(0,a._)("div",Nt,[Bt,(0,a._)("div",Ot," R "+(0,o.zw)(null===(r=e.billingMeterCost)||void 0===r?void 0:r.final_total),1)]),(0,a.Wm)(c,{color:"grey",class:"q-my-xs",size:"2px"}),(0,a._)("div",Lt,[(0,a._)("div",null,"Date: "+(0,o.zw)(null===(d=e.billingMeterCost)||void 0===d?void 0:d.endReadingDate),1),(0,a._)("div",null,"Reading "+(0,o.zw)(null===(s=e.billingMeterCost)||void 0===s?void 0:s.endReading),1)])])]})),_:1})])):((0,a.wg)(),(0,a.iD)("div",$t,[(0,a.Wm)(s,{name:"chevron_left",style:{"margin-top":"-5px"},size:"lg",class:"cursor-pointer",onClick:t[2]||(t[2]=t=>e.previousMonth())}),(0,a.Uk)(" "+(0,o.zw)(null===(r=e.billingMeterCost)||void 0===r?void 0:r.msg)+" ",1),(0,a.Wm)(s,{style:{"margin-top":"-5px"},name:"chevron_right",size:"lg",class:"cursor-pointer",onClick:t[3]||(t[3]=t=>e.nextMonth())})])),(0,a.Wm)(v,{align:"evenly"},{default:(0,a.w5)((()=>{var l,i;return[0!=(null===(l=e.billingMeterCost)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.length)?((0,a.wg)(),(0,a.j4)(m,{key:0,color:"grey-2","text-color":"black",onClick:e.submitBill},{default:(0,a.w5)((()=>[Kt])),_:1},8,["onClick"])):(0,a.kq)("",!0),(0,a.Wm)(m,{color:"grey-2","text-color":"black",onClick:t[4]||(t[4]=t=>e.$emit("close"))},{default:(0,a.w5)((()=>[Gt])),_:1})]})),_:1})]})),_:1})}const Xt=(0,a.aZ)({name:"MeterCost",props:{meter:Object,isNew:Boolean,account:Object,meterCostData:Object},setup(e){var t,l;const o=(0,T.H)(),n=(0,s.H)(),r=(0,u.c)();let d=(0,i.iH)({});const c=(0,i.iH)(),m=r.getAccountById(e.meter.account.id),v=[e.meter],g=(0,R.Z)(),p=(n.getSiteById(m.site.id),new be),w=p.getCost,_=(0,i.iH)(0);var y=o.getReadingsByMeterId(null===e||void 0===e||null===(t=e.meter)||void 0===t?void 0:t.id);const f=(0,a.Fl)((()=>{const e=new Array;return(m.defaultFixedCost||[]).forEach((t=>{"Water Loss Levy"===(null===t||void 0===t?void 0:t.fixed_cost.title)&&e.push({title:t.fixed_cost.title,value:t.value||0})})),e})),h=(0,a.Fl)((()=>{let e=null;return(m.defaultFixedCost||[]).forEach((t=>{var l;"Enter Your Billing Date"===(null===t||void 0===t||null===(l=t.fixed_cost)||void 0===l?void 0:l.title)&&(e=null===t||void 0===t?void 0:t.value)})),m.read_day||24})),b=(0,a.Fl)((()=>{let e=null;const t=q.ZP.formatDate(new Date,"DD");if(h.value<=t){var l=q.ZP.formatDate(new Date,"MMM YYYY");let t=q.ZP.addToDate(l,{month:1});e=q.ZP.formatDate(t,"MMM YYYY")}else e=q.ZP.formatDate(new Date,"MMM YYYY");return e})),M=(0,i.iH)(b.value);M.value=b.value;const D=(0,i.iH)(q.ZP.formatDate(new Date,"DD MMMM YYYY"));let k=[];const A=async()=>{const e=M.value;let t=[];v.forEach((e=>{const l=o.getReadingsByMeterId(e.id);return t=l[l.length-1].time}));let l=q.ZP.formatDate(t,"MMM YYYY");if(e!==l){const t=q.ZP.subtractFromDate(e,{months:1});M.value=q.ZP.formatDate(t,"MMM YYYY")}let a=I(),i=S();k=await x(i,a),console.log("prev",k)},C=async()=>{const e=M.value;let t=q.ZP.addToDate(new Date,{months:1}),l=q.ZP.formatDate(t,"MMM YYYY");if(e!==l){const t=q.ZP.addToDate(e,{months:1});M.value=q.ZP.formatDate(t,"MMM YYYY")}let a=I(),i=S(),o=await x(i,a);console.log("next",o)},x=async(t,l)=>(await new Promise(((a,i)=>{setTimeout((()=>{(0,Me.getParticularMeterCost)(e.meter.account.id,e.meter.id,"",t,l).then((e=>{d.value=e[0],a(e[0])}))}))})),d),S=()=>{let e=q.ZP.addToDate(M.value,{days:h.value-1}),t=q.ZP.subtractFromDate(e,{month:1});return q.ZP.formatDate(t,"YYYY-MM-DD")},I=()=>{let e=null,t=q.ZP.addToDate(M.value,{days:h.value-1}),l=(q.ZP.formatDate(t,"DD MMMM"),q.ZP.formatDate(t,"YYYY-MM-DD"));return e=l,e},Z=(0,a.Fl)((()=>{let e=null,t=q.ZP.addToDate(M.value,{days:h.value-1}),l=q.ZP.formatDate(t,"DD MMMM"),a=(q.ZP.formatDate(t,"YYYY-MM-DD"),q.ZP.subtractFromDate(l,{month:1})),i=q.ZP.formatDate(a,"DD MMMM");q.ZP.formatDate(a,"YYYY-MM-DD");return e=`${i} to ${l}`,e})),Y=p.getSubmitedAndLastReading(y,b.value,h.value);_.value=p.calculateUnitForMonth({isLastReadings:Y,id:null===e||void 0===e||null===(l=e.meter)||void 0===l?void 0:l.type.id});const W=(0,a.Fl)((()=>{var t,l;return 2==(null===e||void 0===e||null===(t=e.meter)||void 0===t||null===(l=t.type)||void 0===l?void 0:l.id)?"kWh":"L"})),U=[{title:"VAT",onTotalAmount:.15}];String.prototype.insert=function(e,t){return e>0?this.substring(0,e)+t+this.substring(e,this.length):t+this};const E=w(_.value,null===e||void 0===e?void 0:e.meter),P=(0,a.Fl)((()=>{let e=0;return f.value.forEach((({value:t})=>{0===E.projection.length&&(e=e+t||0),E.projection.forEach((({title:l})=>{"Electricity bill"!==l?(e=E.total+t,e=V.value.value+e):(e=E.total,e=V.value.value+e)}))})),e})),V=(0,a.Fl)((()=>{const e=new Object;U.forEach((t=>{f.value.forEach((({value:l})=>{E.projection.forEach((({title:a})=>{"Electricity bill"!==a?(e["title"]=t.title,e["value"]=t.onTotalAmount*E["total"]+l*t.onTotalAmount):(e["title"]=t.title,e["value"]=t.onTotalAmount*E["total"])}))}))}));return e}));function F(e,t){g.dialog({title:"Confirm",message:`${e}`,cancel:!0,persistent:!0}).onOk((()=>{t()})).onCancel((()=>{}))}const j=()=>{const t=e.meter,l=1==t.type.id?m.water_email:m.electricity_email,a=`Account: ${m.number}`;let i="";i+=`Account Number: ${m.number}\n`,i+=`Account Holder: ${m.title}\n`,v.forEach((e=>{var t=o.getReadingsByMeterId(e.id);const l=p.getSubmitedAndLastReading(t,b.value,h.value),a=l.lastReading;e.type.id;let n="";n=`Current Reading:${2==e.type.id?a.value:a.value.toFixed(2)}\nDate:\t\t\t${q.ZP.formatDate(new Date(a.time),"DD MMMM YYYY")}\n`,i+=`${e.type.title} Meter:\t${e.number}\n`,i+=`${n}\n`,i+="\n\n"})),i+="Powered by The MyCityApp.\n",i+="Visit www.mycities.co.za for information on how we can help you save on electricity and water with cutting edge technologies.";let n="mailto:"+encodeURI(l)+"?subject="+encodeURI(a)+"&body="+encodeURI(i);console.log(i);const r=q.ZP.formatDate(new Date,"DD");r>=25&&r<=23?window.open(n,"_blank"):F("You are outside the meter reading submission dates. Are you sure you want to email the reading for this meter?",(()=>{window.open(n,"_blank")}))},z=(0,a.Fl)((()=>{const t=q.ZP.formatDate(new Date(Y.lastReading.time),"DD MMMM YYYY"),l=2==e.meter.type.id?5:4,a=Y.lastReading.valueInString.insert(l,".");return{timeDisplay:t,value:a}}));return{getCost:w,usesPerDay:_,unit:W,projectionCost:E,submitBill:j,lastReadingDisplayFormat:z,waterLevyCostByServer:f,totalProjectionCost:P,percentageCharges:U,newVATOnMeterBill:V,isLastReadings:Y,billingCycle:h,billingCycleMonth:b,currentBillPeriod:Z,billingMeterCost:d,alert,previousMonth:A,nextMonth:C,readingPeriod:M,currentDate:D,getPreviousDate:S,getNextDate:I,ms:c}},mounted(){this.nextMonth().then()}}),el=(0,j.Z)(Xt,[["render",Jt],["__scopeId","data-v-7a2a7428"]]),tl=el;He()(Xt,"components",{QCard:Ze.Z,QCardSection:qe.Z,QIcon:ht.Z,QSeparator:We.Z,QCardActions:Fe.Z,QBtn:Pe.Z});var ll=l(8083),al=l(7727);const{formatDate:il}=q.ZP,ol=(0,c.b)(),nl=(0,T.H)(),rl=(0,u.c)(),dl=(0,a.aZ)({name:"MeterReadingSet",props:{meter:Object},setup(e){const t=(0,R.Z)(),l=(0,W.tv)(),o=(0,al.a)();(0,a.bv)((()=>{o.fetchAllData()}));var n=[];const r=(0,i.iH)(!1),d=((0,i.iH)(!0),(0,i.iH)(!1)),s=(0,i.iH)(!1),u=(0,a.Fl)((()=>ol.meters.length)),c=(0,i.iH)(rl.getAccountById(e.meter.account.id)),m=((0,a.Fl)((()=>{let e=0;const t=(n||[]).sort(((e,t)=>e.time-t.time)).reduce(((t,l)=>{var a;const i=new Date(l.time);var o=i.getUTCMonth()+1,n=i.getUTCFullYear();const r=`${n}-${o}`;return(null!==(a=t[r])&&void 0!==a?a:t[r]={group:[],month:o,year:n,index:e++}).group.push({...l}),t}),{});return t})),(0,i.iH)()),v=(0,i.iH)({}),g=(0,i.iH)({}),p=(0,i.iH)(),w=(0,i.iH)({}),_=(0,i.iH)(!1),y=e=>{s.value=!0},f=()=>{const e=(n||[]).sort(((e,t)=>t.time-e.time));g.value=e[0]||{},v.value=e.find((({isSubmit:e})=>e))||e[e.length-1]||{}},h=()=>{var t;n=nl.getReadingsByMeterId(null===e||void 0===e||null===(t=e.meter)||void 0===t?void 0:t.id),f()};(0,a.YP)((()=>{var t;return nl.getReadingsByMeterId(null===e||void 0===e||null===(t=e.meter)||void 0===t?void 0:t.id)}),(e=>{n=e,f()}),{deep:!0}),h();const b=e=>{t.notify({attrs:{role:"alertdialog"},message:e,actions:[{icon:"close","aria-label":"Dismiss"}]})};function M(e,t){l.push({path:`${e}/${t}`})}function D(){const e=g.value.value-v.value.value,t=g.value.time-v.value.time;p.value=e/t*1e3*60*60*24}D();const k=e=>{t.dialog({title:"Confirm",message:"Are you sure you want to delete this meter? All data will be permanently lost.",cancel:!0,persistent:!0}).onOk((()=>{(0,Me.deleteMainMeter)({meter_id:e.id}).then((l=>{200===l.code?(ol.deleteMeter(e),t.notify({message:l.msg||"Meter removed successfully!",color:"positive"})):t.notify({message:l.msg||"Oops, something went wrong!",color:"negative"})})).catch((e=>{var l,a;t.notify({message:(null===(l=e.response)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.msg)||"An unexpected error occurred.",color:"negative"})}))}))};return{modelForReadingSet:r,modelCostForMeter:s,firstReading:v,lastReading:g,currentReading:m,showAlert:b,moveTo:M,usesPerDay:p,isExpand:_,modelMeterForNewEdit:d,selectedAccount:c,deleteMeter:k,meterLength:u,getMeterCost:y,getParticularMeterCost:Me.getParticularMeterCost,meterCostData:w,store:o}},components:{MeterComponent:H,MeterComponentWithInput:Qe,AddMeter:At,MeterCost:tl}});var sl=l(7858),ul=l(9003),cl=l(3706);const ml=(0,j.Z)(dl,[["render",Y],["__scopeId","data-v-da5aa3d2"]]),vl=ml;He()(dl,"components",{QCard:Ze.Z,QCardSection:qe.Z,QBtn:Pe.Z,QMenu:sl.Z,QList:gt.Z,QItem:pt.Z,QItemSection:wt.Z,QSlideTransition:ul.Z,QSeparator:We.Z,QCardActions:Fe.Z,QDialog:cl.Z}),He()(dl,"directives",{Ripple:Dt.Z,ClosePopup:je.Z});const gl=(0,a._)("div",{class:"text-subtitle2 text-white"},"Necessary Details",-1),pl={key:1},wl={key:3},_l={key:5},yl={key:6},fl={key:7},hl={key:1},bl={key:8},Ml={key:9},Dl={key:1},kl={key:11},Al={key:13},Cl=(0,a._)("div",{class:"text-subtitle2 text-white"}," Description under Account setup ",-1),xl=(0,a._)("div",{class:"text-subtitle2 text-white"},"Bill Day and Read Day",-1),Sl={class:"q-card__section q-card__section--vert"},Il={class:"text-h7"},Zl={class:"flex justify-between"},Yl=(0,a._)("div",{class:"text-subtitle2 text-white"},"Additional Cost",-1),Wl={class:"flex justify-between items-center"},ql={class:"text-h7"};function Rl(e,t,l,i,n,r){const d=(0,a.up)("q-card-section"),s=(0,a.up)("q-select"),u=(0,a.up)("q-input"),c=(0,a.up)("q-toggle"),m=(0,a.up)("q-separator"),v=(0,a.up)("q-space"),g=(0,a.up)("q-btn"),p=(0,a.up)("q-card-actions"),w=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(w,null,{default:(0,a.w5)((()=>{var l,i;return[(0,a.Wm)(d,{class:"bg-primary"},{default:(0,a.w5)((()=>[gl])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>{var l,i,n,r;return[e.isNew?((0,a.wg)(),(0,a.j4)(s,{key:0,color:"black",type:"text",label:"Enter a location address","use-input":"","input-debounce":"0",options:e.siteOptions,onFilter:e.filterFn,behavior:"menu",modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=t=>e.site=t),"option-label":"address","emit-value":"","map-options":""},null,8,["options","onFilter","modelValue"])):((0,a.wg)(),(0,a.iD)("div",pl,(0,o.zw)(null===(l=e.site)||void 0===l?void 0:l.address),1)),(0,a._)("h6",null,"Email "+(0,o.zw)(null===(i=e.site)||void 0===i?void 0:i.email),1),e.isNew?((0,a.wg)(),(0,a.j4)(s,{key:2,color:"black",modelValue:e.regionmodel,"onUpdate:modelValue":[t[1]||(t[1]=t=>e.regionmodel=t),t[2]||(t[2]=t=>e.onchangeRegion(t))],options:e.regionOptions,label:"Select Region","option-value":"id","option-label":"name"},null,8,["modelValue","options"])):((0,a.wg)(),(0,a.iD)("div",wl,[(0,a.Wm)(s,{color:"black",modelValue:e.selectedAccount.region_id,"onUpdate:modelValue":[t[3]||(t[3]=t=>e.selectedAccount.region_id=t),t[4]||(t[4]=t=>e.onchangeRegion(t,e.selectedAccount))],options:e.regionOptions,"emit-value":"","map-options":"",label:"Select Region",disable:"",readonly:"","option-value":"id","option-label":"name"},null,8,["modelValue","options"])])),e.isNew?((0,a.wg)(),(0,a.j4)(s,{key:4,color:"black",modelValue:e.accountmodel,"onUpdate:modelValue":t[5]||(t[5]=t=>e.accountmodel=t),options:e.accountOptions,label:"Enter Account Type","option-value":"id","option-label":"type"},null,8,["modelValue","options"])):((0,a.wg)(),(0,a.iD)("div",_l,[(0,a.Wm)(s,{color:"black","emit-value":"",modelValue:e.selectedAccount.account_type_id,"onUpdate:modelValue":t[6]||(t[6]=t=>e.selectedAccount.account_type_id=t),options:e.accountOptions,label:"Enter Account Type","option-value":"id","map-options":"","option-label":"type",disable:"",readonly:""},null,8,["modelValue","options"])])),null!==(n=e.site)&&void 0!==n&&n.ethekwini_water?((0,a.wg)(),(0,a.iD)("div",yl,[(0,a.Wm)(u,{color:"black",type:"text",modelValue:e.site.ethekwini_water,"onUpdate:modelValue":t[7]||(t[7]=t=>e.site.ethekwini_water=t),label:"Enter Water Email"},null,8,["modelValue"])])):((0,a.wg)(),(0,a.iD)("div",fl,[e.isNew?((0,a.wg)(),(0,a.j4)(u,{key:0,color:"black",type:"text",modelValue:e.water_email,"onUpdate:modelValue":t[8]||(t[8]=t=>e.water_email=t),label:"Enter Water Email"},null,8,["modelValue"])):((0,a.wg)(),(0,a.iD)("div",hl,[(0,a.Wm)(u,{color:"black",type:"text",modelValue:e.selectedAccount.water_email,"onUpdate:modelValue":t[9]||(t[9]=t=>e.selectedAccount.water_email=t),label:"Enter Water Email"},null,8,["modelValue"])]))])),null!==(r=e.site)&&void 0!==r&&r.ethekwini_electricity?((0,a.wg)(),(0,a.iD)("div",bl,[(0,a.Wm)(u,{color:"black",type:"text",modelValue:e.site.ethekwini_electricity,"onUpdate:modelValue":t[10]||(t[10]=t=>e.site.ethekwini_electricity=t),label:"Enter Electricity Email"},null,8,["modelValue"])])):((0,a.wg)(),(0,a.iD)("div",Ml,[e.isNew?((0,a.wg)(),(0,a.j4)(u,{key:0,color:"black",type:"text",modelValue:e.electricity_email,"onUpdate:modelValue":t[11]||(t[11]=t=>e.electricity_email=t),label:"Enter Electricity Email"},null,8,["modelValue"])):((0,a.wg)(),(0,a.iD)("div",Dl,[(0,a.Wm)(u,{color:"black",type:"text",modelValue:e.selectedAccount.electricity_email,"onUpdate:modelValue":t[12]||(t[12]=t=>e.selectedAccount.electricity_email=t),label:"Enter Electricity Email"},null,8,["modelValue"])]))])),e.isNew?((0,a.wg)(),(0,a.j4)(u,{key:10,color:"black",type:"text",label:"Enter name - As per bill",modelValue:e.selectedAccount.title,"onUpdate:modelValue":t[13]||(t[13]=t=>e.selectedAccount.title=t),modelModifiers:{trim:!0}},null,8,["modelValue"])):((0,a.wg)(),(0,a.iD)("div",kl,"Name : -"+(0,o.zw)(e.selectedAccount.title),1)),e.isNew?((0,a.wg)(),(0,a.j4)(u,{key:12,color:"black",type:"text",label:"Enter account number - As per bill",modelValue:e.selectedAccount.number,"onUpdate:modelValue":t[14]||(t[14]=t=>e.selectedAccount.number=t)},null,8,["modelValue"])):((0,a.wg)(),(0,a.iD)("div",Al,"Account :- "+(0,o.zw)(e.selectedAccount.number),1))]})),_:1}),(0,a.Wm)(d,{class:"bg-primary"},{default:(0,a.w5)((()=>[Cl])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"black",type:"text",label:"Account description",modelValue:e.selectedAccount.option,"onUpdate:modelValue":t[15]||(t[15]=t=>e.selectedAccount.option=t)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{class:"bg-primary"},{default:(0,a.w5)((()=>[xl])),_:1}),(0,a._)("div",Sl,[(0,a._)("div",Il,[(0,a.Wm)(u,{type:"text",placeholder:"Bill Day",onBlur:t[16]||(t[16]=t=>e.onChanged(t.target.value,e.selectedAccount)),modelValue:e.selectedAccount.bill_day,"onUpdate:modelValue":t[17]||(t[17]=t=>e.selectedAccount.bill_day=t),modelModifiers:{trim:!0}},null,8,["modelValue"]),(0,a._)("div",Zl,[(0,a.Wm)(u,{type:"text",placeholder:"Read Day",modelValue:e.selectedAccount.read_day,"onUpdate:modelValue":t[18]||(t[18]=t=>e.selectedAccount.read_day=t),modelModifiers:{trim:!0}},null,8,["modelValue"]),(0,a.Wm)(c,{modelValue:e.selectedAccount.bill_read_day_active,"onUpdate:modelValue":t[19]||(t[19]=t=>e.selectedAccount.bill_read_day_active=t)},null,8,["modelValue"])])])]),null!==(l=e.selectedAccount)&&void 0!==l&&l.new_additional_cost?((0,a.wg)(),(0,a.j4)(d,{key:0,class:"bg-primary"},{default:(0,a.w5)((()=>[Yl])),_:1})):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===(i=e.selectedAccount)||void 0===i?void 0:i.new_additional_cost,((t,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[(0,a.Wm)(m),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("div",Wl,[(0,a._)("div",ql,(0,o.zw)(null===t||void 0===t?void 0:t.name),1),(0,a.Wm)(c,{modelValue:t.isApplicable,"onUpdate:modelValue":e=>t.isApplicable=e},null,8,["modelValue","onUpdate:modelValue"])]),(0,a.Wm)(u,{type:"number",placeholder:"R0.00",modelValue:t.cost,"onUpdate:modelValue":e=>t.cost=e,modelModifiers:{number:!0},onChange:a=>e.handleChangeInput(t,l)},null,8,["placeholder","modelValue","onUpdate:modelValue","onChange"])])),_:2},1024)],64)))),128)),(0,a.Wm)(m),(0,a.Wm)(v),(0,a.Wm)(p,{align:"center"},{default:(0,a.w5)((()=>[e.autoUpdate?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(g,{key:0,color:"red","text-color":"white",class:"q-my-none q-mx-none",label:"Cancel",glossy:"",onClick:t[20]||(t[20]=t=>e.$emit("close"))})),e.autoUpdate?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(g,{key:1,color:"primary","text-color":"white",class:"q-my-none q-mx-noe",label:"Save",glossy:"",onClick:e.onSaveSelectAccount},null,8,["onClick"]))])),_:1})]})),_:1})}var Ul=l(4710);const El={id:Date.now(),title:null,number:null,option:null,site:{id:null,email:null},fixedCosts:[],defaultCosts:[]},Pl=(0,Ul.t)(),Vl=(0,a.aZ)({name:"AccountComponent",props:{account:Object,autoUpdate:{type:Boolean,default:!1}},methods:{handleChangeInput(e,t){e.name.toLowerCase().includes("rebate")&&e.cost>0&&(this.selectedAccount.new_additional_cost[t].cost=-1*e.cost)},onChanged(e,t){e>=1&&e<=31?this.bill_read_date=e:(this.customalert("This value must be from 1 to 31 represeting the day on which you are billed."),e=1,this.bill_read_date=e,t.bill_day=e),t.read_day=e-5>=0?e-5:25,t.site.id||(t.bill_read_day_active=!1)},onchangeRegion(e,t){t&&t.region_id?(0,Me.regionsgetEmails)(e.id).then((e=>{t.water_email=e.water_email,t.electricity_email=e.water_email})):(0,Me.regionsgetEmails)(e.id).then((e=>{this.water_email=e.water_email,this.electricity_email=e.electricity_email})),null!==t&&void 0!==t&&t.new_additional_cost&&t.region_id&&t.account_type_id&&t.id&&(0,Me.getAdditionalCost)(t.id,t.region_id,t.account_type_id).then((e=>{t.new_additional_cost=e})),console.log("additionalcost",t.new_additional_cost)},onchangeAccountType(e,t){t&&t.region_id?(0,Me.regionsgetEmails)(e.id).then((e=>{t.water_email=e.water_email,t.electricity_email=e.water_email})):(0,Me.regionsgetEmails)(e.id).then((e=>{this.water_email=e.water_email,this.electricity_email=e.electricity_email}))}},emits:["update:account"],setup(e,{emit:t}){var l,o,n;const r=(0,i.iH)([]),d=(0,i.iH)([]),c=(0,i.iH)([]),m=(0,i.iH)([]),v=(0,i.iH)(),g=(0,i.iH)(),p={site:null,selectedAccount:JSON.parse(JSON.stringify(e.account||El))};(0,Me.getAllAccount)().then((e=>{e.data.forEach((t=>{r.value=e.data}))})),(0,Me.getAllRegion)().then((e=>{e.data.forEach((t=>{d.value=e.data}))}));function w(e){f.dialog({dark:!1,message:e,ok:"Ok",color:"positive"})}p["selectedAccount"]["defaultCosts"]=Pl.getDefaultCost.map((e=>("Rates Rebate"===e.title?e["isApplicable"]=!1:e["isApplicable"]=!0,e)));const _=(0,s.H)(),y=(0,u.c)(),f=(0,R.Z)(),h=(0,i.iH)(p.selectedAccount);h.value.region_id&&h.value.account_type_id&&h.value.id&&(0,Me.getAdditionalCost)(h.value.id,h.value.region_id,h.value.account_type_id).then((e=>{h.value.new_additional_cost=e})),h.value.id&&(console.log(h),(0,Me.getBillday)(h.value.id).then((e=>{console.log("response_ms",e),h.value.bill_day=e.bill_day,h.value.read_day=e.read_day,h.value.bill_read_day_active=e.bill_read_day_active}))),null===(l=h.value.defaultFixedCost)||void 0===l||l.map((e=>(1===e.is_active?e["isApplicable"]=!0:e["isApplicable"]=!1,e))),console.log(h);const b=null===(o=y.getAccountById(null===h||void 0===h||null===(n=h.value)||void 0===n?void 0:n.id))||void 0===o?void 0:o.id;console.log(b);const M=(0,a.Fl)((()=>!(null!=b&&void 0!=b&&b>0))),D=(0,i.iH)(M.value?null:_.getSiteById(h.value.site.id)),k=(0,i.iH)(_.allSites);console.log(D);const A=async()=>{let e,l;if(console.log(D),console.log("is_new_account",M.value),M.value){var a,i,o,n;if(console.log("else"),null!==D&&void 0!==D&&null!==(a=D.value)&&void 0!==a&&a.ethekwini_electricity)g.value=null===D||void 0===D||null===(o=D.value)||void 0===o?void 0:o.ethekwini_electricity;if(null!==D&&void 0!==D&&null!==(i=D.value)&&void 0!==i&&i.ethekwini_water)v.value=null===D||void 0===D||null===(n=D.value)||void 0===n?void 0:n.ethekwini_water;if(console.log("new",v.value),console.log("new",g.value),null==c.value.id)return void f.notify({message:"Please select regions"});if(null==m.value.id)return void f.notify({message:"Please select account type"});if(null==v.value)return void f.notify({message:"Please enter water email"});if(null==g.value)return void f.notify({message:"Please enter electricity email"})}else{var r,d,s,u,p,w,b,k,A,C,x;if(console.log(null===D||void 0===D||null===(r=D.value)||void 0===r?void 0:r.ethekwini_electricity),null!==D&&void 0!==D&&null!==(d=D.value)&&void 0!==d&&d.ethekwini_electricity)h.value.electricity_email=null===D||void 0===D||null===(k=D.value)||void 0===k?void 0:k.ethekwini_electricity;if(null!==D&&void 0!==D&&null!==(s=D.value)&&void 0!==s&&s.ethekwini_water)h.value.water_email=null===D||void 0===D||null===(A=D.value)||void 0===A?void 0:A.ethekwini_water;if(null!==h&&void 0!==h&&null!==(u=h.value)&&void 0!==u&&null!==(p=u.account_type_id)&&void 0!==p&&p.id)e=null===(C=h.value.account_type_id)||void 0===C?void 0:C.id;else e=h.value.account_type_id;if(null!==h&&void 0!==h&&null!==(w=h.value)&&void 0!==w&&null!==(b=w.region_id)&&void 0!==b&&b.id)l=null===(x=h.value.region_id)||void 0===x?void 0:x.id;else l=h.value.region_id;if(console.log("account",e),console.log("region",l),null==h.value.region_id)return void f.notify({message:"Please select regions"});if(null==h.value.account_type_id)return void f.notify({message:"Please select account type"});if(h.value.water_email&&null==h.value.water_email)return void f.notify({message:"Please enter water email"});if(h.value.electricity_email&&null==h.value.electricity_email)return void f.notify({message:"Please enter electricity email"})}if(null!=h.value&&h.value.title&&h.value.number){if(M.value)if(D.value.newSite){delete D.value["newSite"];const e=D.value,t=h.value,l=t.defaultCosts.map((e=>({name:e.title,id:e.id,value:e.value,is_active:e.isApplicable?1:0}))).filter((e=>null!==e));(0,Me.addSiteAndAccount)({address:e.address,email:e.email,account_name:t.title,account_number:t.number,optional_information:t.option,default_fixed_cost:l,region_id:c.value.id,account_type_id:m.value.id,water_email:v.value,electricity_email:g.value,bill_day:t.bill_day,read_day:t.read_day,bill_read_day_active:t.bill_read_day_active}).then((({status:l,code:a,msg:i,data:o})=>{console.log(o),l&&(_.addSite({id:o.site_id,address:e.address,title:o.title,user_id:o.user_id,region_id:c.value.id,account_type_id:m.value.id,water_email:v.value,electricity_email:g.value}),y.addAccount({id:o.id,defaultFixedCost:o.default_fixed_costs,number:t.number,option:t.option,site:{id:o.site_id},title:t.title,region_id:c.value.id,account_type_id:m.value.id,water_email:v.value,electricity_email:g.value,bill_day:t.bill_day,read_day:t.read_day,bill_read_day_active:t.bill_read_day_active}))}))}else{const e=h.value,t=e.defaultCosts.map((e=>({name:e.title,value:e.value,id:e.id,is_active:e.isApplicable?1:0}))).filter((e=>null!==e));(0,Me.addSiteAndAccount)({site_id:D.value.id,account_name:e.title,account_number:e.number,optional_information:e.option,default_fixed_cost:t,region_id:c.value.id,account_type_id:m.value.id,water_email:v.value,electricity_email:g.value,bill_day:e.bill_day,read_day:e.read_day,bill_read_day_active:e.bill_read_day_active}).then((({status:t,code:l,msg:a,data:i})=>{t&&y.addAccount({id:i.id,defaultFixedCost:i.default_fixed_costs,number:e.number,option:e.option,site:{id:i.site_id},title:e.title,region_id:c.value.id,account_type_id:m.value.id,water_email:v.value,electricity_email:g.value,bill_day:e.bill_day,read_day:e.read_day,bill_read_day_active:e.bill_read_day_active})}))}else{const t=h.value;console.log(t.defaultFixedCost);t.defaultFixedCost.map((e=>{if(console.log(e),1==e.is_active){let l=null===e||void 0===e?void 0:e.id;const a=t.defaultFixedCost.find((t=>{var l;return(null===t||void 0===t||null===(l=t.fixed_cost)||void 0===l?void 0:l.id)===(null===e||void 0===e?void 0:e.id)}));return a&&(l=null===a||void 0===a?void 0:a.id),{name:e.title,value:e.value,is_active:e.isApplicable?1:0,id:l}}})).filter((e=>null!==e));(0,Me.updateAccount)({site_id:D.value.id,account_name:t.title,bill_day:t.bill_day,read_day:h.value.read_day,bill_read_day_active:t.bill_read_day_active,account_number:t.number,optional_information:t.option,default_fixed_cost:h.value.new_additional_cost,fixed_cost:h.value.new_additional_cost,account_id:t.id,region_id:l,account_type_id:e,water_email:h.value.water_email,electricity_email:h.value.electricity_email}).then((({status:e,code:l,msg:a,data:i})=>{e&&y.update({id:i.id,defaultFixedCost:i.default_fixed_costs,number:t.number,option:t.option,site:{id:i.site_id},title:t.title,region_id:h.value.region_id,account_type_id:h.value.account_type_id,water_email:h.value.water_email,electricity_email:h.value.electricity_email,bill_day:t.bill_day,read_day:h.value.read_day})}))}t("save"),setTimeout((()=>{window.location.reload()}),2e3),await(0,ll.updateAllData)()}else f.notify({message:"Fill valid name and number details"})};let C;const x=(e,t)=>{if(""===e)return void t((()=>{k.value=_.allSites}));const l=e.toLowerCase(),a=_.allSites.filter((e=>e.address.toLowerCase().indexOf(l)>-1));0==a.length?(C&&clearTimeout(C),C=setTimeout((()=>{S(e).then((e=>{t((()=>{k.value=e}))}))}),2e3)):t((()=>{k.value=a}))},S=async e=>{try{const t=await(0,Me.suggestLocation)(e);let l=t.data.suggestions;return l=l.map(((e,t)=>({id:`new-${t}`,title:"",latLng:null,magicKey:e.magicKey,address:e.text,newSite:!0}))),l}catch(t){}},I=async(e,t)=>{try{const l=await(0,Me.findAddressCandidates)(e,t);let a=l.data["candidates"].map(((t,l)=>({id:`new-${l}`,title:"",latLng:{lat:t.location.x,lng:t.location.y},address:e,newSite:!0})));return a}catch(l){}},Z=(0,a.YP)(D,(async(e,t)=>{if(null!==e&&void 0!==e&&e.magicKey)try{let t=await I(e.address,e.magicKey);if(console.log(t),1==t.length){let{data:e}=await(0,Me.findEmailFromLocation)({x:t[0].latLng.lat,y:t[0].latLng.lng});const l=e;console.log("email_data",l),t[0]["email"]=l["features"][0]["attributes"]["MREMAIL"],D.value=t[0],(D.value.address.includes("EThekwini")||D.value.address.includes("eThekwini"))&&(D.value.ethekwini_water="eservices@durban.gov.za",D.value.ethekwini_electricity=D.value.email),console.log("site",D)}else Y("Choose address")}catch(l){console.log(l)}else(e.address.includes("EThekwini")||D.value.address.includes("eThekwini"))&&(D.value.ethekwini_water="eservices@durban.gov.za",D.value.ethekwini_electricity=D.value.email),console.log("else",D)}));function Y({title:e,message:t}){f.dialog({dark:!1,title:e,message:t,cancel:!0,persistent:!1}).onOk((e=>{})).onCancel((()=>{})).onDismiss((()=>{}))}return{selectedAccount:h,onSaveSelectAccount:A,getAllAccount:Me.getAllAccount,siteOptions:k,filterFn:x,site:D,searchByAddress:S,finLatLngByMagicKey:I,watchSite:Z,isNew:M,alert:Y,regionmodel:c,accountmodel:m,regionOptions:d,accountOptions:r,water_email:v,electricity_email:g,getAdditionalCost:Me.getAdditionalCost,customalert:w}}});var Fl=l(4581),jl=l(3175);const zl=(0,j.Z)(Vl,[["render",Rl]]),Hl=zl;He()(Vl,"components",{QCard:Ze.Z,QCardSection:qe.Z,QSelect:Fl.Z,QInput:Ve.Z,QBtn:Pe.Z,QCardActions:Fe.Z,QToggle:jl.Z,QSeparator:We.Z,QSpace:Mt.Z});const Tl=e=>((0,a.dD)("data-v-f94495d4"),e=e(),(0,a.Cn)(),e),Ql={class:"q-gutter-sm"},Nl={class:"text-subtitle1 rounded-borders"},Bl={class:"text-subtitle2"},Ol=Tl((()=>(0,a._)("div",{class:"text-center"},null,-1))),Ll={class:"text-h5 col-auto text-center"},$l=Tl((()=>(0,a._)("div",{class:"text-subtitle2"},"Water Meters",-1))),Kl={class:"q-mb-md q-mt-sm"},Gl={class:"text-subtitle2 q-mb-sm"},Jl={class:""},Xl={class:"col"},ea={key:0,class:"text-blue-7 q-mr-md col"},ta={class:"col-auto"},la={class:"q-mt-sm q-mb-sm"},aa=(0,a.Uk)("Email Now"),ia=Tl((()=>(0,a._)("div",{class:"text-subtitle2"},"Electricity Meters",-1))),oa={class:"q-my-md"},na={class:"text-subtitle2 q-mb-sm"},ra={class:""},da={class:"col"},sa={key:0,class:"col text-blue-7 q-mr-md"},ua={class:"col-auto"},ca=(0,a.Uk)("Email Now"),ma=Tl((()=>(0,a._)("div",{class:"text-subtitle2"},"Additional Charges",-1))),va={class:"q-mt-lg"},ga={class:"col"},pa={class:"col-auto"},wa={class:"q-mt-sm"},_a={class:"row no-wrap"},ya=Tl((()=>(0,a._)("div",{class:"col"},"SubTotal Of All Costs",-1))),fa={class:"col-auto"},ha={class:"row no-wrap"},ba=Tl((()=>(0,a._)("div",{class:"col"},"VAT",-1))),Ma={class:"col-auto"},Da={class:"row no-wrap"},ka=Tl((()=>(0,a._)("div",{class:"col"},"Total including VAT",-1))),Aa={class:"col-auto"},Ca={key:0,class:"row no-wrap"},xa=Tl((()=>(0,a._)("div",{class:"col"},"Rates",-1))),Sa={class:"col-auto"},Ia={key:0,class:"row no-wrap"},Za=Tl((()=>(0,a._)("div",{class:"col"},"Rates Rebate",-1))),Ya={class:"col-auto"},Wa={class:"text-h5"},qa={class:"row no-wrap"},Ra=Tl((()=>(0,a._)("div",{class:"col"},"Total",-1))),Ua={class:"col-auto"},Ea=(0,a.Uk)("The amount is calculated based on your inputs and may differ slightly from your actual municipal bill.");function Pa(e,t,l,i,n,r){const d=(0,a.up)("q-icon"),s=(0,a.up)("q-card-section"),u=(0,a.up)("q-btn"),c=(0,a.up)("q-separator"),m=(0,a.up)("q-item-label"),v=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(v,{class:"mainBackground"},{default:(0,a.w5)((()=>{var l,i;return[(0,a.Wm)(s,{class:"text-h6 headline text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{name:"chevron_left",style:{"margin-top":"-5px"},size:"lg",class:"cursor-pointer",onClick:t[0]||(t[0]=t=>e.previousMonth(e.readingPeriod))}),(0,a._)("span",Ql," Projected bill for "+(0,o.zw)(e.readingPeriod),1),(0,a.Wm)(d,{style:{"margin-top":"-5px"},name:"chevron_right",size:"lg",class:"cursor-pointer",onClick:t[1]||(t[1]=t=>e.nextMonth(e.readingPeriod))}),(0,a._)("div",Nl,(0,o.zw)(e.currentBillPeriod),1),(0,a._)("div",Bl,"Current Date:- "+(0,o.zw)(e.currentDate),1)])),_:1}),Ol,(0,a._)("div",Ll," R "+(0,o.zw)(null===(l=e.fullMetercost)||void 0===l||null===(i=l.final_total)||void 0===i?void 0:i.grand_total),1),(0,a.Wm)(s,null,{default:(0,a.w5)((()=>{var t,l,i,n,r,d,m,v,g,p,w,_,y,f,h,b,M,D,k;return[(0,a.Wm)(s,{class:"titleofcost"},{default:(0,a.w5)((()=>[$l])),_:1}),(0,a._)("div",Kl,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===(t=e.fullMetercost)||void 0===t?void 0:t.water,((t,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[(0,a._)("div",Gl,"Meter: "+(0,o.zw)(l),1),(0,a._)("div",Jl,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===t||void 0===t?void 0:t.projection,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"row no-wrap"},[(0,a._)("div",Xl,(0,o.zw)(e.title),1),null!==e&&void 0!==e&&e.use?((0,a.wg)(),(0,a.iD)("div",ea,(0,o.zw)(e.use)+" KL ",1)):(0,a.kq)("",!0),(0,a._)("div",ta,"R "+(0,o.zw)(e.total),1)])))),128)),(0,a._)("div",la,[(0,a.Wm)(u,{color:"blue-2",rounded:"",unelevated:"","text-color":"black",size:"sm",onClick:l=>e.submitFullBillNew(t)},{default:(0,a.w5)((()=>[aa])),_:2},1032,["onClick"])])])],64)))),128))]),(0,a.Wm)(s,{class:"titleofcost"},{default:(0,a.w5)((()=>[ia])),_:1}),(0,a._)("div",oa,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===(l=e.fullMetercost)||void 0===l?void 0:l.electricity,((t,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[(0,a._)("div",na,"Meter: "+(0,o.zw)(l),1),(0,a._)("div",ra,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===t||void 0===t?void 0:t.projection,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"row no-wrap"},[(0,a._)("div",da,(0,o.zw)(e.title),1),null!==e&&void 0!==e&&e.use?((0,a.wg)(),(0,a.iD)("div",sa,(0,o.zw)(e.use)+" kWh ",1)):(0,a.kq)("",!0),(0,a._)("div",ua,"R "+(0,o.zw)(e.total),1)])))),128)),(0,a.Wm)(u,{class:"q-mt-sm",color:"blue-2",rounded:"",unelevated:"","text-color":"black",size:"sm",onClick:l=>e.submitFullBillNew(t)},{default:(0,a.w5)((()=>[ca])),_:2},1032,["onClick"])])],64)))),128))]),(null===(i=e.fullMetercost)||void 0===i||null===(n=i.additional)||void 0===n?void 0:n.length)>0?((0,a.wg)(),(0,a.j4)(s,{key:0,class:"titleofcost"},{default:(0,a.w5)((()=>[ma])),_:1})):(0,a.kq)("",!0),(0,a._)("div",va,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===(r=e.fullMetercost)||void 0===r?void 0:r.additional,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"row no-wrap",key:t},[(0,a._)("div",ga,(0,o.zw)(e.title),1),(0,a._)("div",pa,"R "+(0,o.zw)(e.total),1)])))),128))]),(0,a.Wm)(c,{class:"q-my-sm"}),(0,a._)("div",wa,[(0,a._)("div",_a,[ya,(0,a._)("div",fa," R "+(0,o.zw)(null===(d=e.fullMetercost)||void 0===d||null===(m=d.final_total)||void 0===m?void 0:m.subtotal_of_all_cost),1)])]),(0,a._)("div",null,[(0,a._)("div",ha,[ba,(0,a._)("div",Ma,"R "+(0,o.zw)(null===(v=e.fullMetercost)||void 0===v||null===(g=v.final_total)||void 0===g?void 0:g.vat),1)])]),(0,a._)("div",null,[(0,a._)("div",Da,[ka,(0,a._)("div",Aa," R "+(0,o.zw)(null===(p=e.fullMetercost)||void 0===p||null===(w=p.final_total)||void 0===w?void 0:w.total_including_vat),1)])]),(0,a._)("div",null,[(null===(_=e.fullMetercost)||void 0===_||null===(y=_.final_total)||void 0===y?void 0:y.rates)>0?((0,a.wg)(),(0,a.iD)("div",Ca,[xa,(0,a._)("div",Sa,"R "+(0,o.zw)(null===(f=e.fullMetercost)||void 0===f||null===(h=f.final_total)||void 0===h?void 0:h.rates),1)])):(0,a.kq)("",!0)]),(0,a._)("div",null,[(null===(b=e.fullMetercost)||void 0===b||null===(M=b.final_total)||void 0===M?void 0:M.rebate)>0?((0,a.wg)(),(0,a.iD)("div",Ia,[Za,(0,a._)("div",Ya," R -"+(0,o.zw)(null===(D=e.fullMetercost)||void 0===D||null===(k=D.final_total)||void 0===k?void 0:k.rebate),1)])):(0,a.kq)("",!0)])]})),_:1}),(0,a.Wm)(c,{class:"q-my-sm"}),(0,a.Wm)(s,{class:"bg-white"},{default:(0,a.w5)((()=>{var t,l;return[(0,a._)("div",Wa,[(0,a._)("div",qa,[Ra,(0,a._)("div",Ua," R "+(0,o.zw)(null===(t=e.fullMetercost)||void 0===t||null===(l=t.final_total)||void 0===l?void 0:l.grand_total),1)])]),(0,a.Wm)(m,{class:"q-mt-md",caption:""},{default:(0,a.w5)((()=>[Ea])),_:1})]})),_:1})]})),_:1})}const Va=(0,a.aZ)({name:"AccountCost",props:{account:Object},setup(e){const t=(0,T.H)(),l=(0,c.b)(),o=(0,s.H)();(0,Me.getParticularMeterCost)(e.account.id,"","fullbill").then((e=>{t.pushfullbillcost({data:e.data})}));let n=t.getfullbillcost();n&&(n=n[0]["data"]),console.log(n);const r=(0,R.Z)(),d=l.getByAccuntId(e.account.id),u=(o.getSiteById(e.account.site.id),new be),m=(0,a.Fl)((()=>{const t=new Array;return(e.account.defaultFixedCost||[]).forEach((e=>{var l;e.is_active&&t.push({title:null===(l=e.fixed_cost)||void 0===l?void 0:l.title,value:(null===e||void 0===e?void 0:e.value)||0})})),t})),v=(0,a.Fl)((()=>{let e=null;return m.value.forEach((({title:t,value:l})=>{"Enter Your Billing Date"===t&&(e=l)})),e||24}));console.log(m);const g=(0,a.Fl)((()=>{let e=null;const t=q.ZP.formatDate(new Date,"DD");if(v.value<=t){var l=q.ZP.formatDate(new Date,"MMM YYYY");let t=q.ZP.addToDate(l,{month:1});e=q.ZP.formatDate(t,"MMM YYYY")}else e=q.ZP.formatDate(new Date,"MMM YYYY");return e})),p=(0,i.iH)(g.value),w=(0,i.iH)(q.ZP.formatDate(new Date,"DD MMMM YYYY")),_=e=>{let l=new Array;d.forEach((e=>{var a=t.getReadingsByMeterId(e.id);return l=a[a.length-1].time}));let a=q.ZP.formatDate(l,"MMM YYYY");if(e!==a){const t=q.ZP.subtractFromDate(e,{months:1});p.value=q.ZP.formatDate(t,"MMM YYYY")}},y=e=>{let t=q.ZP.addToDate(new Date,{months:1}),l=q.ZP.formatDate(t,"MMM YYYY");if(e!==l){const t=q.ZP.addToDate(e,{months:1});p.value=q.ZP.formatDate(t,"MMM YYYY")}},f=(0,a.Fl)((()=>{let e=null,t=q.ZP.addToDate(p.value,{days:v.value-1}),l=q.ZP.formatDate(t,"DD MMMM"),a=q.ZP.subtractFromDate(l,{month:1}),i=q.ZP.formatDate(a,"DD MMMM");return e=`${i} to ${l}`,e})),h=(0,a.Fl)((()=>{const e=new Array;return d.forEach((l=>{var a=t.getReadingsByMeterId(l.id);const i=u.getSubmitedAndLastReading(a,p.value,v.value),o=u.calculateUnitForMonth({isLastReadings:i,id:l.type.id}),n=u.getCost(o,l);n.projection.forEach((t=>{e.push({title:t.title,value:t.value,totalReadingOfMonth:t.reading||null,meter:l})}))})),e}));console.log("calculationsForMeters",h);const b=(0,a.Fl)((()=>{let e=0;return h.value.forEach((({value:t})=>{e+=t})),m.value.forEach((({title:t,value:l})=>{"Rates"!==t&&"Enter Your Billing Date"!==t&&"Rates Rebate"!==t&&(e+=l)})),.15*e})),M=(0,a.Fl)((()=>{let t=0,l=e.account.defaultFixedCost.map((e=>{if(1===e.is_active)return e.value||0}));const a=e=>{const t=e.reduce(((e,t)=>e+(t||0)),0);return t};return t+=a(l),h.value.forEach((({value:e})=>{t+=e})),m.value.forEach((({title:e,value:l})=>{"Rates"===e&&(t-=l),"Enter Your Billing Date"===e&&(t-=l),"Rates Rebate"===e&&(t-=l)})),t})),D=(0,a.Fl)((()=>{let e=M.value;return e+.15*e})),k=(0,a.Fl)((()=>{let e=0;return h.value.forEach((({value:t})=>{e+=t})),m.value.forEach((({title:t,value:l})=>{"Rates Rebate"===t&&(e-=2*l),"Enter Your Billing Date"===t&&(v.value=l,e-=l),e+=l})),e+=b.value,e}));function A(e,t){r.dialog({title:"Confirm",message:`${e}`,cancel:!0,persistent:!0}).onOk((()=>{t()})).onCancel((()=>{}))}const C=t=>{console.log(t);const l=1==t.type?e.account.water_email:e.account.electricity_email,a=`Account: ${e.account.id}`;let i="";i+=`Meter reading:  ${p.value}\n`;let o="";const n=2==t.type?"kWh":"kl";o=t.usage+" "+n,i+=`Account Number: ${e.account.number}\n`,i+=`Account Holder: ${e.account.title}\n`,i+=`Meter Title: ${t.meter_title}\n`,i+=`Meter: ${t.meter_number}\n`,i+=`Current Reading: ${o}\n`,i+="\n\n",i+="Powered by The MyCityApp.\n",i+="Visit www.mycities.co.za for information on how we can help you save on electricity and water with cutting edge technologies.";let r="mailto:"+encodeURI(l)+"?subject="+encodeURI(a)+"&body="+encodeURI(i);console.log(i);const d=q.ZP.formatDate(new Date,"DD");d>=25&&d<=23?window.open(r,"_blank"):A("You are outside the meter reading submission dates. Are you sure you want to email the reading for this meter?",(()=>{window.open(r,"_blank")}))},x=l=>{console.log("dolly"),console.log(l);const a=e.meter;console.log(e);const i=1==a.type.id?e.account.water_email:e.account.electricity_email;console.log(i);const o=`Account: ${e.account.id}`;let n="";n+=`Meter reading:  ${p.value}\n`,String.prototype.insert=function(e,t){return e>0?this.substring(0,e)+t+this.substring(e,this.length):t+this};var r=t.getReadingsByMeterId(l.id);const d=u.getSubmitedAndLastReading(r,p.value,v.value),s=d.lastReading;l.type.id;let c="";c=`Current Reading:${2==l.type.id?s.value:s.value.toFixed(2)}\nDate:\t\t\t${q.ZP.formatDate(new Date(s.time),"DD MMMM YYYY")}\n`,n+=`Account Number: ${e.account.number}\n`,n+=`Account Holder: ${e.account.title}\n`,n+=`${l.type.title} Meter:${l.number}\n`,n+=`${c}\n`,n+="\n\n",n+="Powered by The MyCityApp.\n",n+="Visit www.mycities.co.za for information on how we can help you save on electricity and water with cutting edge technologies.";let m="mailto:"+encodeURI(i)+"?subject="+encodeURI(o)+"&body="+encodeURI(n);console.log(n);const g=q.ZP.formatDate(new Date,"DD");g>=25&&g<=23?window.open(m,"_blank"):A("You are outside the meter reading submission dates. Are you sure you want to email the reading for this meter?",(()=>{window.open(m,"_blank")}))};return{calculationsForMeters:h,calculationsForAccount:m,totalFullBill:k,readingPeriod:p,submitFullBill:x,totalVAT:b,additionalAllCost:M,VATonAdditionalCost:D,previousMonth:_,nextMonth:y,currentDate:w,currentBillPeriod:f,billingCycle:v,fullMetercost:n,submitFullBillNew:C}}}),Fa=(0,j.Z)(Va,[["render",Pa],["__scopeId","data-v-f94495d4"]]),ja=Fa;function za(e,t,l,i,n,r){const d=(0,a.up)("q-card-section"),s=(0,a.up)("MeterHistory"),u=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"bg-primary text-white","text-color":"white"},{default:(0,a.w5)((()=>[(0,a.Uk)(" History Account - "+(0,o.zw)(e.account.title),1)])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.meters,(e=>((0,a.wg)(),(0,a.j4)(d,{key:e.id},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{meter:e},null,8,["meter"])])),_:2},1024)))),128))])),_:1})}function Ha(e,t,l,i,n,r){const d=(0,a.up)("q-td"),s=(0,a.up)("q-btn"),u=(0,a.up)("q-tr"),c=(0,a.up)("q-table");return(0,a.wg)(),(0,a.j4)(c,{dense:e.$q.screen.xs,class:"my-sticky-header-table",title:` ${e.meter.type.title} : ${e.meter.title} ( ${e.meter.number} )`,rows:e.readings,columns:e.columns,"row-key":"name",flat:"",bordered:""},{body:(0,a.w5)((t=>[(0,a.Wm)(u,{props:t},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{key:"time",props:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.date.formatDate(new Date(t.row.time),"DD/MM/YYYY")),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"value",props:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(t.row.value),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"isSubmit",props:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(t.row.isSubmit?"Yes":"-"),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"isDelete",props:t},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{icon:"delete",flat:"",onClick:l=>e.deleteReading(t.row.id)},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["dense","title","rows","columns"])}He()(Va,"components",{QCard:Ze.Z,QCardSection:qe.Z,QBtn:Pe.Z,QIcon:ht.Z,QSeparator:We.Z,QItemLabel:ft.Z,QCardActions:Fe.Z});const Ta=[{name:"time",label:"Date",align:"center",sortable:!0},{name:"value",label:"Reading",align:"center",field:"value"},{name:"isSubmit",label:"Submit",align:"center"},{name:"isDelete",label:"Delete",align:"center"}],Qa=(0,a.aZ)({name:"MeterHistory",props:{meter:Object},setup(e){const t=(0,T.H)(),l=(0,a.Fl)((()=>t.getReadingsByMeterId(e.meter.id))),i=(0,R.Z)(),o=e=>{i.dialog({title:"Confirm",message:"Are you sure you want to delete this entry? This may change your bills calculation.",cancel:!0,persistent:!0}).onOk((()=>{(0,Me.deleteMeterReadings)({reading_id:e}).then((l=>{200===l.code?(t.deleteReadings(e),i.notify({type:"positive",message:l.msg||"Meter reading removed successfully!"})):i.notify({type:"negative",message:l.msg||"Oops, something went wrong!"})})).catch((e=>{var t,l;i.notify({type:"negative",message:(null===(t=e.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.msg)||"An unexpected error occurred."})}))}))};return{readings:l,columns:Ta,date:q.ZP,deleteReading:o}}});var Na=l(1463),Ba=l(3532),Oa=l(7220);const La=(0,j.Z)(Qa,[["render",Ha]]),$a=La;He()(Qa,"components",{QTable:Na.Z,QTr:Ba.Z,QTd:Oa.Z,QBtn:Pe.Z});const Ka=(0,a.aZ)({name:"AccountHistory",props:{account:Object},setup(e){const t=(0,c.b)(),l=t.getByAccuntId(e.account.id);return{meters:l}},components:{MeterHistory:$a}}),Ga=(0,j.Z)(Ka,[["render",za]]),Ja=Ga;He()(Ka,"components",{QCard:Ze.Z,QCardSection:qe.Z});const Xa=e=>((0,a.dD)("data-v-756bd00f"),e=e(),(0,a.Cn)(),e),ei={class:"row gap-2 items-center",id:"site-name"},ti={class:"q-my-sm"},li=(0,a.Uk)("Select "),ai=(0,a.Uk)("Select "),ii=(0,a.Uk)("View Bill"),oi=(0,a.Uk)("View History"),ni=(0,a.Uk)("Edit Account"),ri=(0,a.Uk)("Delete Account"),di=(0,a.Uk)(" Add Account"),si={class:"account_header"},ui=Xa((()=>(0,a._)("img",{alt:"Home-Icon",src:d()},null,-1))),ci=[ui],mi=(0,a.Uk)(" Add New Meters "),vi={class:"column"},gi=(0,a.Uk)(" Start "),pi={__name:"MainPage",setup(e){var t;const l=(0,al.a)();(0,a.bv)((()=>{l.fetchAllData()}));const r=(0,s.H)(),d=(0,u.c)(),v=(0,c.b)(),g=((0,m.L)(),(0,R.Z)()),p=r.allSites;console.log("all_sites",p);v.allMeters;var w=null===(t=d.selectedAccount)||void 0===t?void 0:t.id;const _=e=>d.getAccountById(e);console.log(_(w));const y=e=>d.getAccountsById(e),f=e=>v.getByAccuntId(e),h=()=>{var e;f(null===(e=d.selectedAccount)||void 0===e?void 0:e.id).length>0?g.loading.hide():(g.loading.show(),setTimeout((()=>{g.loading.hide()}),1e3))},b=((0,i.iH)(!0),(0,i.iH)(!0),(0,i.iH)(!0)),M=(0,i.iH)(!0),D=(0,i.iH)(!1),k=(0,i.iH)(!1),A=(0,i.iH)(!1),C=(0,i.iH)(!1),x=(0,i.iH)(!1),S=e=>{console.log(e),d.selectedAccount=e,v.selectedMeter=null,b.value=!0,M.value=!1,D.value=!0,(0,Me.fetchAndSaveMeterOnAccount)(e.id)},I=e=>{let t=v.getByAccuntId(e.id);t.length>0?g.notify({message:"You can only delete an account after you delete all meters associated with the account.",color:"error"}):g.dialog({title:"Confirm",message:"Are you sure you want to delete this account? All data will be permanently lost.",cancel:!0,persistent:!0}).onOk((()=>{(0,Me.deleteMainAccount)({account_id:e.id}).then((t=>{200===t.code?(d.deleteAccount(e),(0,ll.updateAllData)(),g.notify({message:t.msg||"Account removed successfully!",color:"positive"}),setTimeout((()=>{window.location.reload()}),2e3)):g.notify({message:t.msg||"Oops, something went wrong!",color:"negative"})})).catch((e=>{var t,l;g.notify({message:(null===(t=e.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.msg)||"An unexpected error occurred.",color:"negative"})}))}))};return(e,t)=>{const r=(0,a.up)("q-item-label"),s=(0,a.up)("q-item-section"),u=(0,a.up)("q-spinner"),c=(0,a.up)("q-btn"),m=(0,a.up)("q-item"),v=(0,a.up)("router-link"),g=(0,a.up)("q-list"),w=(0,a.up)("q-menu"),_=(0,a.up)("q-separator"),b=(0,a.up)("q-expansion-item"),Z=(0,a.up)("q-toolbar-title"),Y=(0,a.up)("q-toolbar"),W=(0,a.up)("q-header"),q=(0,a.up)("q-page"),R=(0,a.up)("q-dialog"),U=(0,a.Q2)("ripple"),E=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,i.SU)(p).length>0?((0,a.wg)(),(0,a.j4)(q,{key:0},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(g,{bordered:"",separator:"","header-class":"acc-list"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,i.SU)(p),((e,n)=>{var p;return(0,a.wg)(),(0,a.j4)(b,{dense:"","expand-separator":"","default-opened":"","header-class":"bg-primary accounts-list",key:n,class:"q-mt-sm","text-color":"white"},(0,a.Nv)({default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(y(e.id),(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.id},[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"text-h6"},{default:(0,a.w5)((()=>[(0,a.Uk)("Account : "+(0,o.zw)(e.number),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Name : "+(0,o.zw)(e.title),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(s,{center:"",side:""},{default:(0,a.w5)((()=>[e==(0,i.SU)(d).selectedAccount?((0,a.wg)(),(0,a.j4)(c,{key:0,rounded:"",color:"primary","text-color":"white",onClick:t=>{S(e),h()},icon:"check"},{default:(0,a.w5)((()=>[li])),_:2},1032,["onClick"])):((0,a.wg)(),(0,a.j4)(c,{key:1,rounded:"",color:"primary","text-color":"white",onClick:t=>(S(e),h())},{default:(0,a.w5)((()=>[ai])),_:2},1032,["onClick"])),(0,a.Wm)(c,{flat:"",size:"lg",icon:"more_horiz","text-color":"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{anchor:"center middle",self:"center middle"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>{var o,n,r,u,c,g;return[(0,a.Wm)(v,{class:"link",to:{name:"FullBill",params:{id:e.id}}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[ii])),_:1})])),_:1})),[[U]])])),_:2},1032,["to"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{clickable:"",onClick:t=>{(0,i.SU)(d).selectedAccount=e,x.value=!0}},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[oi])),_:1})])),_:2},1032,["onClick"])),[[E]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{clickable:"",onClick:t=>{(0,i.SU)(d).selectedAccount=e,k.value=!0}},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[ni])),_:1})])),_:2},1032,["onClick"])),[[E]]),null!==(o=(0,i.SU)(l))&&void 0!==o&&null!==(n=o.allData)&&void 0!==n&&null!==(r=n.property)&&void 0!==r&&r.property_name?(0,a.kq)("",!0):(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{key:0,clickable:"",onClick:t=>I(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[ri])),_:1})])),_:2},1032,["onClick"])),[[E]]),null!==(u=(0,i.SU)(l))&&void 0!==u&&null!==(c=u.allData)&&void 0!==c&&null!==(g=c.property)&&void 0!==g&&g.property_name?(0,a.kq)("",!0):(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{key:1,clickable:"",onClick:t[0]||(t[0]=e=>{(0,i.SU)(d).selectedAccount=null,k.value=!0})},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[di])),_:1})])),_:1})),[[E]])]})),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,a.Wm)(_)],64)))),128))])),_:2},[null!==(p=e.property)&&void 0!==p&&p.property_name?"Loading..."==(0,i.SU)(l).allData.property.property_name.trim()?{name:"header",fn:(0,a.w5)((()=>[(0,a.Wm)(s,{class:"font-size larger text-white"},{default:(0,a.w5)((()=>[(0,a._)("div",{class:"row gap-2 items-center",id:"site-name"},[(0,a._)("p",{class:"q-mt-md q-my-sm site-name"},"Loading..."),(0,a.Wm)(u,{color:"white",size:"2em",thickness:2})])])),_:1})])),key:"1"}:{name:"header",fn:(0,a.w5)((()=>[(0,a.Wm)(s,{class:"font-size larger text-white"},{default:(0,a.w5)((()=>[(0,a._)("div",{class:"row gap-2 items-center",id:"site-name"},[(0,a.Wm)(r,{class:"q-mt-md site-name"},{default:(0,a.w5)((()=>[(0,a._)("p",{class:"q-my-sm"},[(0,a._)("strong",null,"Name: "),(0,a.Uk)((0,o.zw)((0,i.SU)(l).allData.property.property_name)+" ",1),(0,a._)("strong",null,[(0,a._)("br"),(0,a.Uk)(" Manager: ")]),(0,a.Uk)((0,o.zw)((0,i.SU)(l).allData.property.property_manager),1)])])),_:1})])])),_:1})])),key:"2"}:{name:"header",fn:(0,a.w5)((()=>[(0,a.Wm)(s,{class:"font-size larger text-white"},{default:(0,a.w5)((()=>[(0,a._)("div",ei,[(0,a.Wm)(r,{class:"q-mt-md site-name"},{default:(0,a.w5)((()=>[(0,a._)("p",ti,(0,o.zw)(e.address),1)])),_:2},1024)])])),_:2},1024)])),key:"0"}]),1024)})),128))])),_:1},512),[[n.F8,M.value]]),(0,a.wy)((0,a.Wm)(g,{bordered:"",separator:"","header-class":"meter-list"},{default:(0,a.w5)((()=>{var l,n,r,u,v,g;return[(0,a.Wm)(W,{elevated:"",class:"containerWidth new-meter-heading breadcrumbs"},{default:(0,a.w5)((()=>[(0,a.Wm)(Y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{flat:"",dense:"",round:"",icon:"arrow_back","text-color":"white",onClick:t[1]||(t[1]=e=>{D.value=!1,M.value=!0})}),(0,a.Wm)(Z,{class:"text-white"},{default:(0,a.w5)((()=>{var e,t,l,n;return[(0,a.Uk)(" Manage > Account > "+(0,o.zw)(null===(e=(0,i.SU)(d))||void 0===e||null===(t=e.selectedAccount)||void 0===t?void 0:t.title)+" ("+(0,o.zw)(null===(l=(0,i.SU)(d))||void 0===l||null===(n=l.selectedAccount)||void 0===n?void 0:n.number)+") ",1)]})),_:1})])),_:1})])),_:1}),(0,a._)("div",si,[(0,a._)("i",{class:"home-icon",onClick:t[2]||(t[2]=t=>e.$router.back())},ci),(0,a.Uk)(" "+(0,o.zw)(null===(l=(0,i.SU)(d))||void 0===l||null===(n=l.selectedAccount)||void 0===n?void 0:n.number)+", "+(0,o.zw)(null===(r=(0,i.SU)(d))||void 0===r||null===(u=r.selectedAccount)||void 0===u?void 0:u.title),1)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f(null===(v=(0,i.SU)(d).selectedAccount)||void 0===v?void 0:v.id),(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.id},[(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{clickable:"",class:"q-px-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.j4)(vl,{key:e.id,meter:{...e}},null,8,["meter"]))])),_:2},1024)])),_:2},1024)),[[U]]),(0,a.Wm)(_,{color:"black"})],64)))),128)),0==f(null===(g=(0,i.SU)(d).selectedAccount)||void 0===g?void 0:g.id).length?((0,a.wg)(),(0,a.j4)(m,{key:0,class:"justify-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"primary",rounded:"",outline:"","text-color":"black",icon:"add",onClick:t[3]||(t[3]=e=>A.value=!0)},{default:(0,a.w5)((()=>[mi])),_:1})])),_:1})):(0,a.kq)("",!0)]})),_:1},512),[[n.F8,D.value]])])),_:1})):(0,a.kq)("",!0),0==(0,i.SU)(p).length?((0,a.wg)(),(0,a.j4)(q,{key:1,class:"flex flex-center"},{default:(0,a.w5)((()=>[(0,a._)("div",vi,[(0,a.Wm)(c,{color:"primary",rounded:"","text-color":"black",onClick:t[4]||(t[4]=e=>k.value=!0)},{default:(0,a.w5)((()=>[gi])),_:1})])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(R,{modelValue:x.value,"onUpdate:modelValue":t[7]||(t[7]=e=>x.value=e),onHide:t[8]||(t[8]=e=>x.value=!1),"full-width":!0,"full-height":!1},{default:(0,a.w5)((()=>[(0,a.Wm)(Ja,{account:(0,i.SU)(d).selectedAccount,onClose:t[5]||(t[5]=e=>x.value=!1),onSave:t[6]||(t[6]=e=>x.value=!1)},null,8,["account"])])),_:1},8,["modelValue"]),(0,a.Wm)(R,{modelValue:C.value,"onUpdate:modelValue":t[11]||(t[11]=e=>C.value=e),onHide:t[12]||(t[12]=e=>C.value=!1),"full-width":!0,"full-height":!1},{default:(0,a.w5)((()=>[(0,a.Wm)(ja,{account:(0,i.SU)(d).selectedAccount,onClose:t[9]||(t[9]=e=>C.value=!1),onSave:t[10]||(t[10]=e=>C.value=!1)},null,8,["account"])])),_:1},8,["modelValue"]),(0,a.Wm)(R,{modelValue:k.value,"onUpdate:modelValue":t[15]||(t[15]=e=>k.value=e),onHide:t[16]||(t[16]=e=>k.value=!1),"full-width":!0,"full-height":!0,persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(Hl,{account:(0,i.SU)(d).selectedAccount,onClose:t[13]||(t[13]=e=>k.value=!1),onSave:t[14]||(t[14]=e=>k.value=!1)},null,8,["account"])])),_:1},8,["modelValue"]),(0,a.Wm)(R,{modelValue:A.value,"onUpdate:modelValue":t[19]||(t[19]=e=>A.value=e),onHide:t[20]||(t[20]=e=>A.value=!1),"full-width":!0,"full-height":!0,persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(At,{propsMeter:null,propsAccount:(0,i.SU)(d).selectedAccount,onClose:t[17]||(t[17]=e=>A.value=!1),onSave:t[18]||(t[18]=e=>A.value=!1)},null,8,["propsAccount"])])),_:1},8,["modelValue"])],64)}}};var wi=l(9885),_i=l(651),yi=l(3940),fi=l(6602),hi=l(1663),bi=l(1973);const Mi=(0,j.Z)(pi,[["__scopeId","data-v-756bd00f"]]),Di=Mi;He()(pi,"components",{QPage:wi.Z,QList:gt.Z,QExpansionItem:_i.Z,QItemSection:wt.Z,QItemLabel:ft.Z,QSpinner:yi.Z,QItem:pt.Z,QBtn:Pe.Z,QMenu:sl.Z,QSeparator:We.Z,QHeader:fi.Z,QToolbar:hi.Z,QToolbarTitle:bi.Z,QDialog:cl.Z}),He()(pi,"directives",{Ripple:Dt.Z,ClosePopup:je.Z})},9880:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciICB2aWV3Qm94PSIwIDAgNTAgNTAiIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCI+PHBhdGggZD0iTSAyNC45NjA5MzggMi4xMDE1NjI1IEEgMS4wMDAxIDEuMDAwMSAwIDAgMCAyNC4zODY3MTkgMi4zMTA1NDY5IEwgMS4zODY3MTg4IDIwLjIxMDkzOCBBIDEuMDAwMSAxLjAwMDEgMCAxIDAgMi42MTMyODEyIDIxLjc4OTA2MiBMIDQgMjAuNzA4OTg0IEwgNCA0OCBBIDEuMDAwMSAxLjAwMDEgMCAwIDAgNSA0OSBMIDE4LjgzMjAzMSA0OSBBIDEuMDAwMSAxLjAwMDEgMCAwIDAgMTkuMTU4MjAzIDQ5IEwgMzAuODMyMDMxIDQ5IEEgMS4wMDAxIDEuMDAwMSAwIDAgMCAzMS4xNTgyMDMgNDkgTCA0NSA0OSBBIDEuMDAwMSAxLjAwMDEgMCAwIDAgNDYgNDggTCA0NiAyMC43MDg5ODQgTCA0Ny4zODY3MTkgMjEuNzg5MDYyIEEgMS4wMDAxIDEuMDAwMSAwIDEgMCA0OC42MTMyODEgMjAuMjEwOTM4IEwgMjUuNjEzMjgxIDIuMzEwNTQ2OSBBIDEuMDAwMSAxLjAwMDEgMCAwIDAgMjQuOTYwOTM4IDIuMTAxNTYyNSB6IE0gMjUgNC4zNjcxODc1IEwgNDQgMTkuMTU0Mjk3IEwgNDQgNDcgTCAzMiA0NyBMIDMyIDI5IEEgMS4wMDAxIDEuMDAwMSAwIDAgMCAzMSAyOCBMIDE5IDI4IEEgMS4wMDAxIDEuMDAwMSAwIDAgMCAxOCAyOSBMIDE4IDQ3IEwgNiA0NyBMIDYgMTkuMTU0Mjk3IEwgMjUgNC4zNjcxODc1IHogTSAyMCAzMCBMIDMwIDMwIEwgMzAgNDcgTCAyMCA0NyBMIDIwIDMwIHoiLz48L3N2Zz4="},6889:(e,t,l)=>{e.exports=l.p+"img/logo_small.a35cdb03.png"}}]);